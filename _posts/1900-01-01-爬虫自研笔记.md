---
layout:     post
title:      爬虫自研笔记
subtitle:   潜龙，勿用
date:       1900-01-01
author:     Rainsblue.chan
header-img: ![3](../../../wallpaper/3.jpg)
catalog:   true
tags:
    - 经验
---
## 爬虫自研笔记
## 前言

​		用于学习爬虫的笔记，共勉。采用的课程为拉钩教育的爬虫课。

## 模块一

### 01.必知必会，掌握HTTP基本原理

#### URI、URL、URN

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621202914020.png" alt="image-20230621202914020" style="zoom:50%;" />

```URI和URL
例如：
https://github.com/favicon.ico既是一个URL，也是一个URI。
即有这样的一个图标资源，用URL/URI来唯一指定了它的访问方式，
这其中包括了访问协议HTTPS、访问路径（即github的根目录）和资源名称favicon.ico
```

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621203232056.png" alt="image-20230621203232056" style="zoom:50%;" />

URL（统一资源定位符）是URI（统一资源标识符）的一个子集，URI还有一个子类叫做URN（统一资源名称，**它只负责命名资源而不制定如何定位资源**）。所以这个URL的作用是资源的**定位**，这是标识的一个细化，可以说是**特别的标识**。**只要一个资源有定位符，它则一定是URI的一种**。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621203547812.png" alt="image-20230621203547812" style="zoom:50%;" />

我们看这幅图和这个例子，URN命名了一本书作为资源，它可以唯一标识这本书，**但是没有指定到哪里定位这本书**。

现在一般URN非常少，URL也可称作为URI（**网页链接**）。

![image-20230621204812916](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621204812916.png)

ctrl+u查看源代码，都是超文本。

#### HTTP和HTTPS概念

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621204937712.png" alt="image-20230621204937712" style="zoom:50%;" />

URL开头的这个http或者https就是访问资源所需要的协议类型。这两股协议是最常见的。我们来了解一下它们的含义。

![image-20230621205304617](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205304617.png)

```HTTP概念
HTTP（Hyper Text Transfer Protocol）
中文名叫做超文本传输协议，用于从网络传输超文本数据到本地浏览器的传送协议，能保证高效而准确地传送超文本文档。
由来是万维网协会和IETF（互联网工作小组）共同指定的规范。
目前广泛使用的HTTP1.1版本。
```

![image-20230621205623679](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205623679.png)

```HTTPS概念
多了一个套接层，SSL。大势所趋。
它的主要作用可以分为两种：
1.建立一个信息安全通道，来保证数据传输的安全
2.确认网站的真实性，凡是使用了HTTPS的网站，都可以通过点击浏览器地址的锁头标志来查看网站认证之后的真实信息，也可以通过CA机构颁发的安全签章来查询。
```

![image-20230621205952581](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205952581.png)

#### HTTP请求过程

![image-20230621210134303](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621210134303.png)

输入URL，回车，实质是浏览器向网站服务器发送一个请求request，网站服务器接受到这个请求进行处理和解析，返回对应的response，传回给浏览器。响应里面会有网页源代码，浏览器会对这些超文本进行一个解析，就比如标签直接读掉，类似这种。

##### 开发者工具network选项卡使用

![image-20230621211021477](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621211021477.png)

![image-20230621211716430](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621211716430.png)

我们打开百度，进入开发者工具，查看网络选项卡。这里以我自己的截图举例子，我们看见网络下面有几个块，名称，状态，类型（type，指我们所请求的文件类型），启动器，大小，响应时间和可视化瀑布流。

我们这里以名称为“www.baidu.com"举例，它的状态为200，就是正常，类型为document，代表我们这里请求的是一个**“html文档”**，size如果是cache就是缓存的概念，说明曾经打开过这个网站？不是很理解，但是不太重要。

这里type这个标签还是很重要的吧。

![image-20230621212051878](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621212051878.png)

点开它，能够详细看到它的一些信息。

##### General部分

Request URL是指请求的网页，Request Method是指请求方法，Status Code为状态码，Remote Address，远程服务器地址端口，Referer Policy是判别策略。

响应头和请求头，请求头中带有许多请求信息，例如**浏览器标识**，**cookie**，**Host**等信息。这是请求的一部分。

![image-20230621225725985](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225725985.png)

服务器会**根据请求头内的信息判断请求是否合法**，进而做出对应的响应。Response Headers就是响应的一部分。

![image-20230621225923041](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225923041.png)

当中包含了服务器的类型，文档的类型，日期，这里GMT就是格林威治时间，我们在东八区，所以可知我现在是2023年6月21号晚上九点十六分在百度进行了一次请求。Server这里是百度自己的服务器，我搜了一下。

![image-20230621230258564](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621230258564.png)

还有一篇相关问答，[说是用来代替阿帕奇的](http://www.aiyiweb.com/linux/22997)。链接附在这段字下面了。

浏览器接收到响应会解析响应内容并显示在网页上。

#### 请求（GET和POST）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621230613872.png" alt="image-20230621230613872" style="zoom:50%;" />

![image-20230621231325437](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621231325437.png)

做web题的时候也常用这种方式，就是一个？跟着所需参数=某个数值。经常就是?c=system('tac fla?.txt');这种形式，就是**GET传参**

![image-20230621231340881](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621231340881.png)

这点也有一点点体会，我记得post传参是以表单的形式，不是在url中修改，一般都是hackbar直接post。我们看一下区别。

![image-20230621232259056](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232259056.png)

就两个区别，一个是get传参写在url里面，post是写在请求体里的，另外一个是字节限制，get最多1024bytes，post则没有限制。

一般来说，登陆时包含了登陆密码，其中涉及到了**敏感信息**，使用GET的方式，密码就会暴露在url里面，造成密码的泄露，所以最好以post的方式发送，较大也会用post。

还有一些其他的请求方式，总结为下表。

![image-20230621232805049](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232805049.png)

请求的网址，即**统一资源定位符URL**，可以唯一确定我们想请求的资源。请求头说明了附加信息，比较重要的信息有**cookie、referer、user-agent**

#### （重要）请求头分析（cookie、referer、user-agent）

![image-20230621232916967](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232916967.png)

![image-20230621233228239](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233228239.png)

![image-20230621233542244](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233542244.png)

![image-20230621233736681](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233736681.png)

![image-20230621234028796](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234028796.png)

```分析ing
Accept：请求报头域，用于指定客户端可接受哪些类型的信息
这里我们看，text/html代表html格式，也有图像类image/apng代表apng图片，application/xhtml+xml代表xhtml+xml类型。当中其实是Content-Type，对照表网址为http://tool.oschina.net/commons,
Accept-Language：指定客户端可接受的语言类型
这里支持中文英文。
Accept-Encoding：指定客户端可接受的内容编码
gzip，deflate，br
Host：用于指定请求资源的主机IP和端口号，其内容为请求URL的原始服务器或网关的位置，从HTTP1.1版本开始，请求必须包含此内容
这里看见Host就是baidu。
Cookie：很重要，这是网站为了辨别用户进行会话跟踪而存储在用户本地的数据，它的主要功能是维持当前访问会话。如果你讲一个登陆了的网站的cookie删除，那么自动你就从网页中掉出去。上面那张图解释的很清楚了。
```

![image-20230621234055032](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234055032.png)

![image-20230621234128871](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234128871.png)

![image-20230621234331459](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234331459.png)

所以Referer是标识请求来源，UA则是标识客户使用的操作系统及版本，比如你可以使得一个普通浏览器换成微信浏览器的标识，这样你就可以伪装成微信浏览器。

在写爬虫时，大部分时间都需要请求头。

#### 请求体

![image-20230621234655724](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234655724.png)

登录github输入完账号密码，这样回车之后就会以表单形式提交给服务器，此时需要注意，**request headers制定content-type为application/x-www-form-urlencoded**，才会以表单的数据形式提交。以url形式编码。

也可以将content-type设置为json，来提交json的内容。或者设置multipart/form-data来上传文件。

![image-20230621235325396](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235325396.png)

在制作爬虫时，如果需要使用post，必须正确了解content-type。、

#### 响应体

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235456734.png" alt="image-20230621235456734" style="zoom:50%;" />

有各种状态码，一般200就是正常返回数据。其他遇到问题再搜。

![image-20230621235602881](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235602881.png)

![image-20230621225923041](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225923041.png)

响应编码为gzip，文档类型返回为text/html，html文档，用的utf-8编码，Server为百度自研1.1，这里有三个set-cookies，我估计是有不同的地方会用到，比如搜索栏，比如登录。

![image-20230622000611300](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230622000611300.png)

响应体就是爬虫最后要解析的东西。

请求网页返回html源码，而图片则是它的二进制。

### 02.夯实根基，Web 网页基础

#### 网页的组成三大件：HTML、JavaScript、CSS

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230622213016300.png" alt="image-20230622213016300" style="zoom:67%;" />

HTML相当于骨架、CSS是渲染格式，所以是皮肤、JavaScript是脚本，执行操作，所以相当于人体运动的肌肉，三者完整结合在一起才能形成网页。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624134740705.png" alt="image-20230624134740705" style="zoom:50%;" />

HTML定义网页的内容和结构，CSS描述网页的布局，JavaScript定义网页的行为。

##### HTML（Hyper Text Markup Language，超文本标记语言）

HTML是用来**描述网页**的一种语言

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624113333616.png" alt="image-20230624113333616" style="zoom:67%;" />

不同类型的元素通过不同类型标签来表示，如上图所示。

在网页当中选择开发者模式，elements选项卡中展示的就是HTML源码。下图为示例。

这里就是用div嵌套做一个个模块。

![image-20230624113600325](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624113600325.png)

![image-20230624122903222](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624122903222.png)

相互嵌套组合，形成了网页架构。但只有html的元素的网页并不美观，为了让网页更加美观，所以出现了CSS。

##### CSS（Cascading Style Sheets，层叠样式表）

![image-20230624123518409](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624123518409.png)

层叠是**排版**，而样式更像是word文档中调整文字格式大小，颜色等等的一个操作。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624130033048.png" alt="image-20230624130033048" style="zoom:50%;" />

```css
#head_wrapper.s-ps-islite.s-p-top{		
#大括号前面是一个css选择器，这个选择器的作用首先是选中id为head_wrapper且class为s-ps-islite节点，然后再选中其中为s-p-top的节点
大括号其中的就是一条条样式规则
postion指定了这个元素的布局方式为绝对布局（absolute）
bottom指定了元素的下边距为40像素
width决定了宽度占百分之百
height决定元素的高度
```

等于就是我们把位置、宽度、高度统一写成这样的形式，然后用大括号括起来，接着在开头补充一个css选择器，这就代表**css选择器对于选中的元素生效了**。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624133009812.png" alt="image-20230624133009812" style="zoom: 50%;" />

我们看上面举过的实例。这里就是引用了testcss.css作为自己网页的一个层叠样式表。

![image-20230624133133012](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624133133012.png)

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624133358466.png" alt="image-20230624133358466" style="zoom:50%;" />

我们可以相对来修改一下它，比如图片之类的，就能够更好地来理解。

![image-20230624133553857](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624133553857.png)

这里我将第一块的图片给换了，就长这样。

现在HTML和CSS只是静态信息，为了使得网页具有交互效果，我们需要JS。

##### JavaScript（简称JS，一种脚本语言）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624134027750.png" alt="image-20230624134027750" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624134101213.png" alt="image-20230624134101213" style="zoom:50%;" />

就如上图所示，在HTML中通过script，也就是JavaScript的script标签引入。script本身的意思就是脚本，所以这就是脚本标签。

#### 网页的结构

![image-20230624135541944](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624135541944.png)

```
这里比较重要的是要注意div标签。它定义了网页中的区块，id是container，这是一个非常常用的属性，且id在网页中的内容是唯一的。我们可以通过它来获取这个区块。
这个区块内又有一个div标签，这里定义一个class为wrapper，这也是非常常用的属性，经常与css配合使用来设定样式。
```

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624135250017.png" alt="image-20230624135250017" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624140659775.png" alt="image-20230624140659775" style="zoom:67%;" />

新建一个文本文件，然后应该在浏览器上的呈现就会是这样。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624135949771.png" alt="image-20230624135949771" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624140017080.png" alt="image-20230624140017080" style="zoom:50%;" />

这里我们就有这样一个例子，作者没用id的方式，而是直接用class，说明内容量不多吧，然后直接引用的css中的div.第一块来作为一个样式的修改。

#### 节点树及节点间的关系（DOM）

在HTML中，**所有标签定义的内容都是节点**，它们构成了一个**HTML DOM树**。

DOM是W3C（万维网联盟）的标准，其英文全称为Document Object Model，即文档对象模型。

![image-20230624140942015](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624140942015.png)

DOM是一个接口，用于程序、脚本动态访问，更新文档内容、结构和样式。

W3C也根据对象分为3个不同的部分，核心DOM（**针对任何结构化文档，泛用性广**），XML DOM（只针对XML文档），HTML DOM（只针对HTML）。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624141550927.png" alt="image-20230624141550927" style="zoom:67%;" />

根据W3C的HTML DOM标准，HTML文档中的所有内容都是节点：

- 整个文档是一个文档节点
- 每个HTML元素是元素节点
- HTML元素内的文本是文本节点
- 每个HTML属性是属性节点
- 注释是注释节点

##### HTML节点树

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624141905083.png" alt="image-20230624141905083" style="zoom:50%;" />

```HTML节点树
通过HTML DOM
树中的所有节点均可通过JavaScript访问
所有HTML节点元素均可被修改
也可以被创建或删除
```

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624142239775.png" alt="image-20230624142239775" style="zoom:50%;" />

##### 定位节点（css选择器）

> 一般我们会用css选择器来定位节点，比如<div id="container">

这个就表示为 **#container**，其中  #  开头代表选择id，其后紧跟id的名称。

如果要选择class为wrapper的节点，可以使用  **.wrapper**

这里  .  开头代表选择class，其后紧跟class的名称，也可使用根据标签名筛选，如想选择二级标题，直接用h2即可。

![image-20230624142658900](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624142658900.png)

支持**嵌套选择**，各个选择器加上空格分隔开代表嵌套。如#container .wrapper p（中间有两个空格）

- 代表先选择id为container的节点
- 然后再选中其**内部**为wrapper的节点
- 然后再进一步选中其内部的p节点

如果不加空格，则代表**并列关系**，如div#container .wrapper p.text（但这个例子应该是没有并列...）

- 代表先选择id为container的div节点
- 然后选中其内部的class为wrapper的节点
- 再进一步选中其内部的class为text的p节点

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624143801110.png" alt="image-20230624143801110" style="zoom:67%;" />

这里能看见并列关系用的是**逗号，** 

还有一种常用的选择器是**XPath**，之后会提到。

### 03.原理探究，了解爬虫的基本原理

#### 爬虫概述

爬虫就是获取网页并提取和保存信息的自动化程序。蜘蛛通过节点连线，获取下一个节点，这样所有的节点都可以被爬取到。

##### 获取网页

爬虫首先要做的就是**获取网页**，就是获取网页的源代码。

**源代码里包含网页的部分有用信息**，只要把源代码获取下来，就可以从中提取想要的信息。

前面讲了**请求**和**响应**的概念。向服务器发送一个请求，返回的**响应体**便是网页的源代码。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626091852403.png" alt="image-20230626091852403" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626091918093.png" alt="image-20230626091918093" style="zoom:50%;" />

我们可以利用这些库非常方便地完成**HTTP请求操作**。

请求和响应都可以用类库提供的数据结构来表示。得到响应之后，只需要解析数据结构中的body部分即可，即得到**网页源代码**。这样我们就可以用程序来实现获取网页内容的过程了。

##### 提取信息

获取网页源代码后，接下来就是分析网页源代码，从中提取想要的数据。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626092416653.png" alt="image-20230626092416653" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626092432288.png" alt="image-20230626092432288" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626092446589.png" alt="image-20230626092446589" style="zoom:50%;" />

```
两种方法：
最通用的方法是采用正则表达式提取，这是万能方案，但是构造容易出错。
第二种方法基于网页结构的规则，所以有一些根据网页节点属性、css选择器或XPath来提取网页信息的库，
比如Beautiful Soup、pyquery、lxml等等，它们可以高效提取节点属性、文本值等等。
```

##### 保存数据

提取信息后，一般会将提取到的数据保存到某处以便后续使用。

保存形式多种多样，如可以简单保存为**TXT文本或者JSON文本**。

也可以保存到数据库，如**MySQL和MongoDB**等。

还可以保存到远程服务器，如**借助SFTP进行操作**等。

##### 自动化程序

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626092923370.png" alt="image-20230626092923370" style="zoom:50%;" />

自动化程序的出现就是为了大量采集数据。

#### 能抓怎样的数据

```
在网页中能看到各种各样的信息，最常见的便是常规网页，它们对应着HTML代码，而最常抓取的便是HTML源代码。

有些网页返回的不是HTML代码，而是一个JSON字符串。而且这种数据提取会更加方便。

网页中还会有二进制文件，比如图片，视频和音频，利用爬虫可以将他们捕捉下来改成对应文件名。
```

#### JavaScript渲染页面

有时用urllib或requests抓取网页时，**得到的源代码实际和浏览器中看到的不一样**。

这是非常常见的情况，现在网页越来越多的采用**Ajax、前端模块化工具**来构建，

整个网页可能都是有JavaScript渲染出来的，即通过这个脚本重新写入HTML代码。

**原始的HTML代码可能就是一个空壳。**

例子如下图。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626094244345.png" alt="image-20230626094244345" style="zoom:50%;" />

这里我们看见在html代码中body里只有一个节点为container。后面呢引入了这个app.js的脚本。

如果这个时候我们用urllib或者requests来做一个html的请求，那么得到的只会是这一段HTML的代码。

因此使用基本HTTP请求库得到的源代码可能和浏览器中的页面源代码不太一样，可以分析其后台Ajax接口，也可使用Selenium、Splash这样的库来实现模拟JavaScript渲染。

### 04.基础探究，Session与Cookies

我们在网页浏览时经常会遇到登录的情况，有些网页只有登录之后才能够访问，而登录之后可以连续很多次的访问网站，但是有时候过一段时间就需要重新登录。还有一些网站，打开浏览器就自动登录了，而且很长时间都不会失效。

这种情况设计**Session和Cookies**的相关知识。

#### 静态网页和动态网页

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626095228058.png" alt="image-20230626095228058" style="zoom:50%;" />

静态网页一般会放在公网服务器上，一般配置有nginx或者apache。

但是存在很大缺陷，比如**可维护性差，不能根据URL灵活多变地显示内容**等。比如输入一个name参数，就没有办法找。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626095431401.png" alt="image-20230626095431401" style="zoom: 67%;" />

动态网页可以动态解析URL中参数的变化，**关联数据库**并动态呈现不同的页面内容，非常灵活多变。

现在遇到的大多数网站都是动态网站，不再是一个简单的HTML。

可能由JSP、PHP、Python等语言编写，其功能比静态网页强大和丰富太多，

动态网站还可以实现用户登录和注册的功能。

这种功能需要一个**特殊的凭证**，而这就是**Session和Cookies**的作用。

而在了解它们之前，我们必须了解HTTP的一个特点，叫做无状态。

#### 无状态HTTP

HTTP特点之一——**无状态**

是指**HTTP协议对事务处理是没有记忆能力的，也就是说服务器不知道客户端是什么状态**。

HTTP有点像我，记性很差。

当我们向服务器发送请求后，服务器解析这个请求，然后返回对你的响应，服务器负责完成这个过程，而且这个过程是完全独立的，**服务器不会记录前后状态的变化，也就是缺少记录。**

这就意味着，**如果后续需要处理前面的信息，则必须重传**，这也导致需要额外传递一些前面的重复请求，才能获取后续响应。然而这种效果肯定不是我们想要的，为了保持前面的状态，我们还得全部重传一次，这太浪费资源了，对于这种需要用户登录的页面来说，更是棘手。

```
例如，一个人需要登录网站，他做了一次这个操作，当他再需要进入网站，那么他还要做一次这个操作。（如果没有session和cookies）
```

于是两个保持HTTP连接状态的技术就出现力！就是我们的Session和Cookies。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626101348601.png" alt="image-20230626101348601" style="zoom:80%;" />

![image-20230626102557122](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626102557122.png)

在服务端：网站的服务器用来保存用户的Session信息，我们可以简单称之为**会话信息**。

在客户端：可以理解为浏览器端，浏览器在下次访问网页时会自动附带上它发送给服务器，**服务器通过识别Cookies并鉴定出是哪个用户，然后再判断用户是否是登录状态，进而返回对应的响应**。这种响应的表现形式就是你的网页，比如你在网页端登录了bilibili，那么这个时候的响应就是你的右上角有个头像。

有了cookies，浏览器在下次访问网页时，会自动附带上它，把他发送给服务器，我们可以理解为cookies里面保存了用户的凭证，因此下次登录就不需要再次输入用户名密码等信息，重新登陆。

因此在爬虫中，有时候处理一些需要登录才能访问的页面，我们一般**会将登录成功之后获取的这个cookies放在请求头中直接请求**，而不必重新模拟登录。

好了，详细地了解了它们的概念之后，我们剖析它们的原理。

#### Session（会话）

其本身的含义是指**有始有终的一系列动作/消息**。

比如打电话时，从拿起电话拨号到挂断电话这中间的一系列过程可以称为一个session，有点像反序列化中，我们的魔术手套，**不改变数据结构，但是只改变属性**，动作相同的证明，正式那个反序列化值。这里的session值，**就是这些动作的证明**。

在Web中，Session对象用来存储特定用户Session所需的属性及配置信息。这样当用户跳转页面，session变量中所存储的信息不会丢失。下面是百度的，讲的也差不离。

[session的概念](https://baike.baidu.com/item/session/479100?fr=aladdin)，在计算机中，尤其是在网络应用中，称为**“会话控制”**。**Session对象存储特定用户会话所需的属性及配置信息。**这样，当用户在应用程序的Web页之间跳转时，存储在Session对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。**（这样就不会被无状态，或说是无记忆的HTML影响）**当用户请求来自应用程序的 Web页时，如果该用户还没有会话，**则Web服务器将自动创建一个 Session对象。**当会话过期或被放弃后，服务器将终止该会话。Session 对象最常见的一个用法就是**存储用户的首选项**。例如，如果用户指明不喜欢查看图形，就可以将该信息存储在Session对象中。有关使用Session 对象的详细信息，请参阅“ASP应用程序”部分的“管理会话”。注意会话状态仅在支持cookie的浏览器中保留。

#### Cookies

指某些网站**为了辨别用户身份、进行Session跟踪而存储在用户本地终端上的数据**。

我们接下来讲一下这个过程：

##### **当客户端第一次请求服务器时**

服务器会返回一个响应头中带有**Set-Cookie字段**的响应给客户端

用来标记是哪一个用户，客户端浏览器会把Cookies保存起来

比如我这里搜索赛尔号，就是向百度的BWS服务器发送一个请求，这个post被解析之后会返回一个带有set-cookie字段的response，见下图，这用于标记我。

![image-20230626112827958](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626112827958.png)

##### **当浏览器下一次再请求该网站时**

浏览器会把此Cookies放到请求头一起提交给服务器

Cookies携带了Session ID信息，服务器检查该Cookies即可找到对应的Session是什么

然后判断Session来以此辨认用户状态

或者我们就说bilibili得了

![image-20230626113416909](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626113416909.png)

这是一样的，Set-Cookie会在这里做一个标记。这里有我的Session ID信息，然后就能交给服务器判断。

##### **在成功登录某个网站时**

服务器会告诉客户端设置哪些Cookies信息

在后续访问页面时客户端会把Cookies发送给服务器，服务器再找到对应的Session加以判断

如果Session中的某些设置登录状态的变量是有效的

就证明用户处于登录状态

**此时返回登录之后才可以查看的网页内容，浏览器再进行解析便可以看到了。**

反之，Cookies无效则返回上一页面。

##### Cookies位置

位于**开发者选项卡中application里的Storage**。

![image-20230626143637884](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626143637884.png)

这其中有很多条目，每一个条目都可以称作是一个**Cookie**。

它有以下几个属性：

- **Name**，即该Cookie的名称，这里要注意，**Cookie一旦创建，Name就不可能更改。**
- **Value**，即该Cookie的值，**如果值为Unicode字符，需要为字符编码**，**如果值为二进制属性，则需要使用base64编码**。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626144155771.png" alt="image-20230626144155771" style="zoom:80%;" />

- **Expires/Max-Age**，第一个i-cookie（有点没听清）生成的时间，单位为秒。常和Expires一起使用，计算cookie有效时间。**Max-Age如果为正数，则value，cookie在（max-age秒）之后失效。如果Max-Age为负数，则关闭浏览器时cookie即失效。**（浏览器也不会以任何形式保存该cookie）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626145029762.png" alt="image-20230626145029762" style="zoom:50%;" />

- **Path**，即该cookie的使用路径，如果设置为Path路径，将只有路径设置为path的路径能够访问该cookie。如果设置为根路径，则本域名下所有的页面都可以访问该cookie。
- **Domain**，即可以访问该cookie的域名。例如设置为.zhihu.com，则所有以zhihu.com为结尾的都可以访问该cookie。
- **Size**,cookie大小。
- **HTTP**，即**此cookie的HTTP-only属性**。若此属性为True，则只有在HTTP-header中会带有此cookie的信息。**而不能通过document.cookie来访问此cookie。

##### 会话Cookie和持久Cookie

会话Cookie（Session-Cookie）就是把Cookie放在浏览器内存里，浏览器在关闭之后该Cookie即失效（**短时使用**）

持久Cookie则会保存到客户端的硬盘中，下次还可以继续使用，用于长久保持用户登录状态

**严格来说**，没有会话Cookie和持久Cookie之分，只是由Cookie的Max Age或Expires字段决定了过期的时间。Max Age为正就是cookie在Max Age秒之后失效，为负就是关闭浏览器后失效。**持久Cookie就是相应把Session有效时间调长一些**。

#### 登录Session控制的实现图

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626143113839.png" alt="image-20230626143113839" style="zoom:50%;" />

登录会话控制由两者共同协作，服务器端是Session来记录会话信息和属性，客户端是Cookies来记录用户信息。以此来填补HTML的无状态（无记忆）。

#### 常见误区

##### **在谈论Session机制时**

并不是将浏览器关闭，Session就消失，**而是会保留在服务器上，除非程序通知服务器删除一个session**。

**比如程序一般都是在我们做注销操作时才去删除Session**。我们做个实例。

- **注销前**

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626151156571.png" alt="image-20230626151156571" style="zoom:67%;" />

- **注销后**

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230626151245663.png" alt="image-20230626151245663" style="zoom: 67%;" />

我们看见这个Session因为注销被删除了，关闭浏览器后Session也没有删除。

##### **当关闭浏览器时**

但是浏览器不会在关闭之前主动通知服务器它将要关闭，所以**服务器根本不会有机会知道浏览器已经关闭**。

之所以有这种错觉，是因为大部分网站都用的是会话Cookie。（**Cookie随关随注销**）当再次连接到服务器，没了cookie自然找不到session，不过，如果硬盘存储了cookie或是改写了请求头，那么仍然能恢复连接状态，找到session-id。

##### **由于关闭浏览器不会导致Session被删除**

这就需要服务器为Session设置一个失效时间，当距离客户端上一次使用Session的时间超过这个失效时间时，服务器就可以认为客户端已经停止了活动，才会把Session删除以节省存储空间。

### 05.多路加速，了解多线程基本原理

我们知道，在一台计算机中可以同时打开许多软件，比如同时打字听音乐。

这涉及到**多线程和多进程**。

为了提高爬虫效率，同样也需要这方面知识。我们这里主要是看如何在python中实现这种过程。

#### 多线程的含义

进程可以理解为一个**可以独立运行的程序单位**。比如开一个notepad，就是开启一个notepad进程。

一个进程中**可以同时处理很多事情**，比如浏览器可以在多个选项卡中打开多个页面，可以同时运行，互不干扰。

为什么能同时运行这么多任务？**任务对应着线程的执行。**

进程是线程的集合，是由一个或多个线程构成的，线程则是**操作系统进行运算调度的最小单位，是进程中的一个最小运行单元**。

比如上面的浏览器进程，播放音乐就是一个线程。

多线程就是**一个进程中同时执行多个线程**。

#### 并发和并行

![image-20230627073319815](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627073319815.png)

并发只有一个核，同一时刻只能有一条指令，看上去多个线程同时执行，实际上是快速切换；

并行需要多处理器，多线程同一时刻执行。

#### 多线程适用场景

在一个程序进程中，有些操作是比较**耗时**或者**需要等待**的，如：

- 等待数据库的查询结果的返回
- 等待网页结果的响应

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627073649527.png" alt="image-20230627073649527" style="zoom:80%;" />

使用单线程，处理器必须要等待这些操作完成才能继续执行，这个时候处理器被闲置；

使用多线程，处理器就可以在某个线程等待时执行其他线程，从而从整体上提高执行效率。

**网络爬虫**就是一个典型的例子，爬虫在向服务器发送请求之后，有一段时间必须要等待服务器的响应返回，这种任务就属于**IO密集型任务（IO-bound）（CPU相较为闲置）**。但也不是所有的任务都是IO-bound，还有**CPU密集型（CPU-bound）**，就是任务的运行一直需要处理器参与，这个时候IO就被闲置。**如果这个时候开启多线程，那么从一个cpu-bound切换到另一个cpu-bound，处理器依旧不会停下来，始终会忙于计算。（这样并不会节省总体的时间，因为所需要处理的任务量的总量是不变的）**

##### 总结

如果任务不全是CPU-bound，那么可以使用多线程来提高程序整体执行效率**（就是把CPU等待时间全给它变成执行）**，尤其对于**网络爬虫这种IO-bound任务**来说，使用多线程会**大大提高程序整体的爬取效率**。

#### Python实现多线程

##### threading、join、守护线程

在Python中，实现多线程的模块叫做**threading**，是Python自带的模块。下面开始演示。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: threadtest
import threading
import time

def target(second):
    print(f'Threading {threading.current_thread().name} is running')
    print(f'Threading {threading.current_thread().name} sleep {second}s')
    time.sleep(second)
    print(f'Threading {threading.current_thread().name} is ended')

print(f'Threading {threading.current_thread().name} is running')
for i in [1,5]:
    t = threading.Thread(target=target, args=[i])
    t.start()
    t.join()
print(f'Threading {threading.current_thread().name} is ended')
```

首先，我们可以使用thread类来创建一个线程。创建时需要**指定target参数为运行的方法名称**，如果被调用的方法需要插入额外的参数，则可以通过**thread-args**来指定。

在这里，我们首先声明了一个方法，叫做**target**。它接收一个参数叫做**second**，通过方法的实现可以发现，这个方法就是实现了一个**time.sleep**休眠操作，second参数就是**休眠秒数**。提前后print一些内容。其中线程的名字，我们可以通过**threading.current_thread().name**获取。如果是主线程，起值就是main thread，如果是子线程，起值就是thread-*，这个就是代表线程自己的名称。

然后我们通过thread类新建了两个线程，target参数就是我们定义的方法名，args，以列表的方式来呈递，两次循环中，这里i分别是1和5，这样两个线程休眠时间分别为1秒和5秒。声明完成之后，就可以通过start开始运行。

![image-20230627083218902](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627083218902.png)

主线程首先运行结束，然后是两个子线程接连运行结束，分别间隔1秒和4秒。这说明主线程并没有等待子线程并结束运行，而是直接退出了，有些不符合常理。

如果我们想要主线程等待子线程运行完毕再退出，可以让每个子线程都调用下面的**join方法**。 

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627084345524.png" alt="image-20230627084345524" style="zoom: 50%;" />

另外，也可以通过继承thread类的方式，需要在方法中写入run。

如果一个线程被设置为守护线程，那么就说明这个线程是不重要的。这就意味着如果主线程结束了，守护线程还没有运行完，那么它将被**强制结束**。在Python中，我们可以通过**setDaemon**方法来设置守护线程。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: threadtest
import threading
import time

def target(second):
    print(f'Threading {threading.current_thread().name} is running')
    print(f'Threading {threading.current_thread().name} sleep {second}s')
    time.sleep(second)
    print(f'Threading {threading.current_thread().name} is ended')

print(f'Threading {threading.current_thread().name} is running')
t1 = threading.Thread(target=target, args=[2])
t1.start()
t2 = threading.Thread(target=target, args=[5])
t2.setDaemon(True)	#3.7可以这么写，如果是3.10，用t.daemon=true
t2.start()
print(f'Threading {threading.current_thread().name} is ended')
```

![image-20230627085341040](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627085341040.png)

这里我们没有看见Thread2退出的信息，说明随着MainThread的退出而退出了。这里并没有调用join方法，如果调用，仍然会等待，无论是否为守护线程。

图为加了join后

![image-20230627085713584](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627085713584.png)

##### 互斥锁

在一个进程中的多个线程是共享资源的，比如在一个进程中有一个全局变量count用于计数，现在我们声明多个线程，每个线程运行值都给count加1，让我们看看效果如何。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: threadtest
import threading
import time

count = 0

class MyThread(threading.Thread): # 定义一个创建线程
    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        global count
        temp = count + 1
        time.sleep(0.001)
        count = temp

threads =[] # 创建一个空列表用于记录？大概
for _ in range(1000): # 不使用迭代变量，也就是同样内容执行1000次
    thread = MyThread()
    thread.start()
    threads.append(thread)

for thread in threads:
    thread.join() # 等待thread进程结束
print(f'Final count: {count}') # f-string，统计count次数
```

结果如下

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627091624864.png" alt="image-20230627091624864" style="zoom:50%;" />

在这里我们声明了1000个线程，各休眠一小段时间，然后对count赋予新的值。那这样**按照常理，count值应该是1000**。但是count居然是8。原因是因为**count是共享的，每个线程都可以在执行count = temp这段代码时拿到count的值。但是这些线程可以是并发或者并行执行的。这就导致了不同的线程可能拿到的是同一个count值，加1操作也就没有生效，最后导致结果偏小。**不同的电脑可能在这里结果不一样，但是结果大致都是偏小的。

所以，**如果多个线程同时对某个数据进行读取或者修改，就会出现不可预料的结果**。为了避免这种情况，我们需要对多个线程进行**同步**，要实现同步，我们可以对需要操作的数据进行**加锁保护**。这里就需要threading.Lock（）了。

##### 加锁保护

某个线程在对数据进行操作前，需要先**加锁**，这样其他的线程发现被加锁了之后，就无法继续向下执行，会一直等待锁被释放，只有加锁的线程把锁释放了，其他的线程才能继续加锁并对数据做修改，修改完了再释放锁，**这样可以确保同一时间只有一个线程操作数据，多个线程不会再同时读取和修改同一个数据**，最后的运行结果就是对的了。我觉得这有点类似于并发。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: threadtest
import threading
import time

count = 0

class MyThread(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        global count
        lock.acquire() # 获取count前先加锁
        temp = count + 1
        time.sleep(0.001)
        count = temp
        lock.release() # run完之后再释放锁

lock = threading.Lock()
threads =[] # 创建一个空列表用于记录？大概
for _ in range(1000): # 不使用迭代变量，也就是同样内容执行1000次
    thread = MyThread()
    thread.start()
    threads.append(thread)

for thread in threads:
    thread.join() # 等待thread进程结束
print(f'Final count: {count}') # f-string，统计count次数
```

在run方法中，在获取count前先加锁，等线程run完之后再释放锁。这样多个线程就不会同时修改操作同一个count值了。

![image-20230627094927086](C:/Users/14682/AppData/Roaming/Typora/typora-user-images/image-20230627094927086.png)

#### Python多线程的问题（GIL）

**GIL**，全称为Global Interpreter Lock，译为**全局解释器锁**。其最初设计是为了数据安全而考虑的。

由于python中GIL的限制，**无论是多核和单核，同一时刻只能运行一个线程**，这直接**导致python多线程无法发挥多核并行的优势**。这里一定要注意一点，GIL限制的是**线程**，不是进程。

在Python多线程下，每个线程的执行方式如下：

- 获取GIL
- 执行对应线程的代码
- 释放GIL

##### Python多线程下同一时刻只能运行一个线程的核心原因

我们可以把GIL想象成一张通信证，并且一个Python进程中只有一个GIL。拿不到通信证的线程就不允许执行，所以多线程下只能一个个来的原因，就在于此。

不过对于爬虫这种IO-bound来说，这个影响并不大（**原因是因为爬虫发送一个HTML请求后大多数时间都是在等待，cpu在这段时间内闲置**），而对于Cpu-bound，由于GIL的存在，多线程的效率可能会比单线程还低。

### 06.多路加速，了解多进程基本原理

上面讲的多线程，然后还提到Python中的多线程是不能很好的发挥多核的优势（**并行**）

#### 多进程的含义

进程（Process）是具有一定独立功能的程序关于某个数据集合上的一次运行活动，是系统进行和资源分配和调度的一个独立单位，**多进程就是启用多个进程同时运行**。由于进程是线程的集合，所以一个进程运行就是**大于等于线程数量运行**。

#### Python多进程的优势

上一回说到，**由于进程中GIL的存在，Python中的多线程并不能很好地发挥多核优势，一个进程中的多个线程，同一时刻只能有一个线程运行。**这是线程的劣势。

然而**对于进程**，对于多进程来说，每个进程都有属于自己的GIL，**所以在多核处理器下，多进程的运行是不会受GIL的影响的，多进程能更好地发挥多核的优势**。（即，受GIL影响，多线程只能并发，而多进程仍旧并行，依旧坚挺）

当然，对于爬虫这种IO-bound来说，多线程和多进程实际差别并不大。而对于Cpu-bound任务，python的多进程会比多线程有成倍的提升。

##### 小总结

Python的多进程整体比多线程更有优势，在条件允许情况下能用多进程就尽量用多进程。

由于进程是系统进行资源分配和调度的一个**独立单位**，所以各个进程之间的数据是**无法共享的**。上面的线程例子也可以很好证明，**不加锁就有可能公用一个count变量，然后那个数值就并不会等于线程量而是小于它。**

#### 多进程的实现（multiprocessing）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627175301941.png" alt="image-20230627175301941" style="zoom:50%;" />

这是一个库，提供很多功能。

##### 直接使用Process类

在multiprocessing中，每个进程都用一个Process类来表示

API调用：

```api
先解释一下何为API调用：
文章链接：https://weibo.com/ttarticle/p/show?id=2309404717603309355717
应用程序编程接口 (API) 是一组规则，使软件程序能够将数据传输到另一个软件程序。API 使开发人员能够避免冗余工作；与构建和重建已经存在的应用程序功能不同，开发人员可以通过按照 API 要求格式化请求，将现有功能整合到他们的新应用程序中。
API 是一种“接口”，意思是一种事物与另一种事物进行交互的方式。作为一个真实的例子，ATM 有一个界面——一个屏幕和几个按钮——允许客户与他们的银行互动并请求服务，比如取钱。同样，API 是一个软件如何与另一个程序交互以获得所需服务的方式。
想象一下，詹妮弗建立了一个网站，帮助通勤者在上班前检查公路交通。Jennifer 可能会花费大量时间和金钱来建立一个复杂的高速公路跟踪系统，以将这些信息提供给她网站的用户。但是这些能力已经存在，因为外部各方已经创建了这样的系统。Jennifer 的网站没有以这种方式重新发明轮子，而是使用由外部高速公路跟踪服务提供的 API。现在 Jennifer 可以专注于构建网站的其他方面。也就是用已经做好的模块。

什么是 API 调用？
API 调用，也称为 API 请求，是指向触发 API 使用的 API 的消息。回顾该示例，Jennifer 构建她的网站时，它会在加载时自动生成对高速公路跟踪服务的 API 调用。响应从该服务返回到网站，并使其能够显示最新的高速公路交通信息。
API 调用必须按照 API 的要求进行格式化才能工作。API 的要求称为其“架构”。该模式还描述了提供给每个请求的响应类型。
假设一位通勤者使用 Jennifer 的网站检查 192 号高速公路上的交通情况。该网站发送一个 API 调用来提供此信息 — 一条消息，内容为“192 号高速公路”。高速公路跟踪服务的 API 服务器收到此消息并回复 192 号高速公路上的行驶时间。
```

**Process([group [,target [,name [,args [,kwargs]]]]])**

- **target**表示调用对象，你可以传入方法的名字
- **args**表示被调用对象的位置参数元组

比如target是函数func，他有两个参数m，n，那么args就传入[m, n]即可

- **kwargs**表示调用对象的字典，如kwargs = {'name':Jack, 'age':18}
- **name**是别名，相当于给这个进程取一个名字
- **group**是分组

接下来是一个实例，一个简单的创建。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: 06processtest
import multiprocessing

def process(index):
    print(f'Process: {index}')

if __name__== '__main__':
    for i in range(5):
        p = multiprocessing.Process(target=process, args=(i,)) 
        # 注意这里的args必须是一个元组，如果只有一个参数，那么就要在元组的第一个元素后面加一个逗号
        # 如果没有这个逗号，那么这个和单个元素本身是没有区别的，这会导致参数的传递有问题
        p.start()
```

![image-20230627181844420](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230627181844420.png)

结果就是这样，我们看一下它讲了什么。很简单，就是使用multiprocessing这个类，通过start即可启动，然后就会出现五个子进程，每个子进程都是调用了process方法。Process的index参数通过args传入，分别是0到4。

各个进程的数据不会共享，当前cpu核数不同的话，还会分配不同的核来执行进程，真正做到并行。

```python
几个比较有用的方法：
通过cpu_count方法来获取当前机器CPU的核心数量
通过active_children方法获取当前还在运行的所有进程
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: 06processtest
import multiprocessing
import time

def process(index):
    time.sleep(index)
    print(f'Process: {index}')

if __name__== '__main__':
    for i in range(5):
        p = multiprocessing.Process(target=process, args=[i])
        p.start()
    print(f'CPU number: {multiprocessing.cpu_count()}')
    for p in multiprocessing.active_children():
        print(f'Child process: {p.name} id: {p.pid}')
    print('Process Ended')
```

结果如下，发现我电脑有16个核。不同机器结果可能不同。通过p.name和p.pid可以很方便地得到进程信息。

![image-20230628072253225](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230628072253225.png)

以上我们就通过**直接使用Process类**完成多进程创建和一些基本信息的获取。

##### 继承Process类

创建进程的方式不止一种，也可以像线程Thread一样来通过继承的方式创建一个进程类，进程的基本操作在子类的run方法中实现即可。我们通过一个实例来看。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
from multiprocessing import Process
import time

class MyProcess(Process):
    def __init__(self, loop): # 接受一个参数loop作为循环次数
        Process.__init__(self)
        self.loop = loop

    def run(self):
        for count in range(self.loop):
            time.sleep(1)
            print(f'Pid: {self.pid} LoopCount: {count}')

if __name__ == '__main__':
    for i in range(2,5): # i打印2，3，4
        p = MyProcess(i)
        p.start()
```

![image-20230628220546179](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230628220546179.png)

不同的机器，不同的时刻，运行时间可能不同。

##### 守护进程（类似守护线程，当主进程结束后，守护进程直接关闭）

如果一个进程被设置为守护进程，当父进程结束后，子进程会自动被终止，可以通过**设置daemon属性**来控制是否为守护进程。下面还是例子。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
from multiprocessing import Process
import time

class MyProcess(Process):
    def __init__(self, loop):
        Process.__init__(self)
        self.loop = loop

    def run(self):
        for count in range(self.loop):
            time.sleep(1)
            print(f'Pid: {self.pid} LoopCount: {count}')

if __name__ == '__main__':
    for i in range(2,5):
        p = MyProcess(i)
        p.daemon = True
        p.start()

print('Main Process ended')
```

![image-20230628221625584](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230628221625584.png)

可以防止无控制的执行子进程。但是这里主进程直接运行结束了，因为给每一个子进程都设置了守护进程。

所以这里同样要进程等待，**join方法**。

```Python
if __name__ == '__main__':
    for i in range(2,5):
        p = MyProcess(i)
        p.daemon = True
        p.start()
        p.join()
```

结果如下

```无
Main Process ended
Pid: 35344 LoopCount: 0
Pid: 35344 LoopCount: 1
Main Process ended
Pid: 4492 LoopCount: 0
Pid: 4492 LoopCount: 1
Pid: 4492 LoopCount: 2
Main Process ended
Pid: 44224 LoopCount: 0
Pid: 44224 LoopCount: 1
Pid: 44224 LoopCount: 2
Pid: 44224 LoopCount: 3
Main Process ended
```

在调用start方法之后，父进程就在等待所有子进程运行完毕，join方法是无限等待，所以子进程没有完成，父进程就结束不了。所以可以加一些限制时间，这就是**父进程的最长等待时间**，当这个时间用完，父进程强制退出。

```Python
if __name__ == '__main__':
    for i in range(2,5):
        p = MyProcess(i)
        p.daemon = True
        p.start()
        p.join(1)
```

结果一下子就少了很多。

```None
Main Process ended
Pid: 18204 LoopCount: 0
Main Process ended
Pid: 18204 LoopCount: 1Pid: 30540 LoopCount: 0

Main Process ended
Main Process ended
```

运行一秒就被强制返回了。

##### 终止进程

终止进程当然不止守护进程一种方法，还可以通过**terminate方法**来终止某个子进程，还可以通过**is_alive方法**判断进程是否还在运行。

接下来是实例

```Python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
import multiprocessing
import time

def process(): # 休眠
    print('Starting')
    time.sleep(5)
    print('Finished')

if __name__ == '__main__':
    p = multiprocessing.Process(target=process)
    print('Before:', p, p.is_alive())

    p.start()
    print('During:', p, p.is_alive)

    p.terminate()
    print('Terminate:', p, p.is_alive())

    p.join()
    print('Joined:', p, p.is_alive())
```

结果如下；

```
Before: <Process name='Process-1' parent=29032 initial> False
During: <Process name='Process-1' pid=32040 parent=29032 started> <bound method BaseProcess.is_alive of <Process name='Process-1' pid=32040 parent=29032 started>>
Terminate: <Process name='Process-1' pid=32040 parent=29032 started> True
Joined: <Process name='Process-1' pid=32040 parent=29032 stopped exitcode=-SIGTERM> False
```

##### 进程互斥锁

我们上面执行的一些结果，经常会出现没有换行的结果，这是因为**并行**的结果。

```
如果能保证多个进程运行期间的任一时间，
只能一个进程输出，其他进程等待，
等刚才那个进程输出完毕之后，
另一个进程再进行输出
就不会出现输出没有换行的现象
```

这种方案实际就是实现了**进程互斥**。多个进程同时抢占临界区，即输出资源，我们可以通过lock实现，就是加锁。

我们先实现一个不加锁的。

```Python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
from multiprocessing import Process, Lock
import time

class MyProcess(Process):
    def __init__(self, loop, lock):
        Process.__init__(self)
        self.loop = loop
        self.lock = lock

    def run(self):
        for count in range(self.loop):
            time.sleep(0.1)
            # self.lock.acquire()
            print(f'Pid: {self.pid} LoopCount: {count}')
            # self.lock.release()

if __name__ == '__main__':
    lock = Lock()
    for i in range(10, 15):
        p = MyProcess(i, lock)
        p.start()
```

我们看一下结果

```
Pid: 30504 LoopCount: 0
Pid: 35192 LoopCount: 0
Pid: 39400 LoopCount: 0
Pid: 36484 LoopCount: 0
Pid: 35300 LoopCount: 0
Pid: 36484 LoopCount: 1
Pid: 39400 LoopCount: 1Pid: 35192 LoopCount: 1

Pid: 35300 LoopCount: 1
Pid: 30504 LoopCount: 1
Pid: 35300 LoopCount: 2Pid: 36484 LoopCount: 2
Pid: 30504 LoopCount: 2
Pid: 35192 LoopCount: 2Pid: 39400 LoopCount: 2


Pid: 35300 LoopCount: 3Pid: 39400 LoopCount: 3Pid: 35192 LoopCount: 3Pid: 36484 LoopCount: 3Pid: 30504 LoopCount: 3




Pid: 30504 LoopCount: 4Pid: 39400 LoopCount: 4
Pid: 35192 LoopCount: 4Pid: 35300 LoopCount: 4


Pid: 36484 LoopCount: 4
Pid: 35300 LoopCount: 5Pid: 36484 LoopCount: 5
Pid: 30504 LoopCount: 5
Pid: 35192 LoopCount: 5Pid: 39400 LoopCount: 5


Pid: 36484 LoopCount: 6Pid: 30504 LoopCount: 6Pid: 35192 LoopCount: 6
Pid: 39400 LoopCount: 6


Pid: 35300 LoopCount: 6
Pid: 39400 LoopCount: 7Pid: 35300 LoopCount: 7Pid: 35192 LoopCount: 7Pid: 30504 LoopCount: 7Pid: 36484 LoopCount: 7




Pid: 36484 LoopCount: 8Pid: 30504 LoopCount: 8Pid: 35192 LoopCount: 8Pid: 35300 LoopCount: 8Pid: 39400 LoopCount: 8




Pid: 35192 LoopCount: 9
Pid: 36484 LoopCount: 9Pid: 35300 LoopCount: 9
Pid: 30504 LoopCount: 9
Pid: 39400 LoopCount: 9

Pid: 39400 LoopCount: 10Pid: 35192 LoopCount: 10Pid: 30504 LoopCount: 10Pid: 35300 LoopCount: 10



Pid: 35300 LoopCount: 11
Pid: 35192 LoopCount: 11Pid: 30504 LoopCount: 11

Pid: 30504 LoopCount: 12Pid: 35192 LoopCount: 12

Pid: 30504 LoopCount: 13
```

我们看结果当中出现的内容会有很多同行问题，现在我们加锁，把注释取消。

```
Pid: 27840 LoopCount: 0
Pid: 30592 LoopCount: 0
Pid: 30952 LoopCount: 0
Pid: 15508 LoopCount: 0
Pid: 40872 LoopCount: 0
Pid: 27840 LoopCount: 1
Pid: 40872 LoopCount: 1
Pid: 30952 LoopCount: 1
Pid: 15508 LoopCount: 1
Pid: 30592 LoopCount: 1
Pid: 27840 LoopCount: 2
Pid: 15508 LoopCount: 2
Pid: 30592 LoopCount: 2
Pid: 30952 LoopCount: 2
Pid: 40872 LoopCount: 2
Pid: 27840 LoopCount: 3
Pid: 30952 LoopCount: 3
Pid: 15508 LoopCount: 3
Pid: 30592 LoopCount: 3
Pid: 40872 LoopCount: 3
Pid: 27840 LoopCount: 4
Pid: 40872 LoopCount: 4
Pid: 30592 LoopCount: 4
Pid: 15508 LoopCount: 4
Pid: 30952 LoopCount: 4
Pid: 27840 LoopCount: 5
Pid: 15508 LoopCount: 5
Pid: 30592 LoopCount: 5
Pid: 30952 LoopCount: 5
Pid: 40872 LoopCount: 5
Pid: 27840 LoopCount: 6
Pid: 40872 LoopCount: 6
Pid: 30592 LoopCount: 6
Pid: 30952 LoopCount: 6
Pid: 15508 LoopCount: 6
Pid: 27840 LoopCount: 7
Pid: 30952 LoopCount: 7
Pid: 15508 LoopCount: 7
Pid: 30592 LoopCount: 7
Pid: 40872 LoopCount: 7
Pid: 27840 LoopCount: 8
Pid: 40872 LoopCount: 8
Pid: 30592 LoopCount: 8
Pid: 30952 LoopCount: 8
Pid: 15508 LoopCount: 8
Pid: 27840 LoopCount: 9
Pid: 30952 LoopCount: 9
Pid: 40872 LoopCount: 9
Pid: 30592 LoopCount: 9
Pid: 15508 LoopCount: 9
Pid: 15508 LoopCount: 10
Pid: 30592 LoopCount: 10
Pid: 30952 LoopCount: 10
Pid: 40872 LoopCount: 10
Pid: 30952 LoopCount: 11
Pid: 40872 LoopCount: 11
Pid: 15508 LoopCount: 11
Pid: 15508 LoopCount: 12
Pid: 40872 LoopCount: 12
Pid: 15508 LoopCount: 13
```

现在看见输出结果就正常了，所以**进程互斥锁可以使得只有一个进程能在同一时刻访问共享资源**。

##### 信号量

信号量是进程同步过程中一个比较重要的角色

可以**控制临界资源的数量**

实现多个进程同时访问共享资源，限制进程的并发量

**可以用multiprocessing库中的Semaphore来实现信号量**。

经典的生产者-消费者问题

```python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
from multiprocessing import Process, Semaphore, Lock, Queue
import time

buffer = Queue(10)
empty = Semaphore(2)
full = Semaphore(0)
lock = Lock()

class Consumer(Process):
    def run(self):
        global buffer, empty, full, lock
        while True:
            full.acquire()
            lock.acquire()
            buffer.get()
            print('Consumer pop an element')
            time.sleep(1)
            lock.release()
            empty.release()

class Producer(Process):
    def run(self):
        global buffer, empty, full, lock
        while True:
            empty.acquire() # 缓冲区空闲区大小减一，占有位置
            lock.acquire()  # 加锁
            buffer.put(1)
            print('Producer append an element')
            time.sleep(1)
            lock.release() # 释放锁
            full.release() # 缓冲区占用区大小加一

if __name__ == '__main__':
    p = Producer()
    c = Consumer()
    p.daemon = c.daemon = True
    p.start()
    c.start()
    p.join()
    c.join()
    print('Main Process Ended')
```

定义了一个生产者一个消费者，buffer中利用**multiprocessing.Queue()**定义了一个10的队列，然后定义了两个信号量**Semaphore**，并代表缓冲区的空余数（empty）和缓冲区的占有数（full），

生产者Producer使用**acquire方法**，来占有一个缓冲区位置，然后缓冲区空闲区大小减1，接下来进行加锁。然后释放锁，

代表占有的缓冲区位置加一。这就是很简单，**要工作，空闲区少去一个人，要休息，工作区位置空出来一个人**。消费者则相反。

Producer不断放入物品，Consumer不断地取出，这就是一个循环。

##### 队列（Queue）

让进程共享数据，这里的队列指的是multiprocessing里面的Queue。

##### 管道（Pipe）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629113049737.png" alt="image-20230629113049737" style="zoom:50%;" />

##### 进程池

假如有10000个任务，每个任务需要启动一个进程来执行，并且一个进程运行完毕之后要紧接着启动下一个进程，同时还需要控制进程的并发数量，不能并发太高。不然CPU处理不过来（如果同时运行的进程能维持在一个最高恒定值当然利用率是最高的）

进程池即multiprocessing中的Pool，可以提供指定数量的进程供用户调用，当有新的请求提交到pool中时，如果池还没有满，就会创建一个新的进程用来执行该请求，如果池中进程数已达到规定最大值，那么该请求就会等待直到池中有进程结束，才会创建新的进程来执行它。

```python
# Author: Rainsblue.chan
# Create: 2023/6/28
# FileName: 06继承
from multiprocessing import Pool
import time

def function(index):
    print(f'Start process: {index}')
    time.sleep(3)
    print(f'End process {index}',)

if __name__ == '__main__':
    pool = Pool(processes=3)
    for i in range(4):
        pool.apply_async(function, args=(i,))
    print('Main Proess started')
    pool.close()
    pool.join()
    print('Main Process Ended')
```

这里我们声明了一个大小为3的进程值， 通过**processes参数来指定**，如果不指定，它会根据内核数来分配。接着我们使用**apply_async方法**添加进程。apply_async是multiprocessing模块中的一个方法，用于在进程池中异步地执行一个函数或者方法。它的主要作用是将函数的执行和结果的获取分离开来，从而提高程序的执行效率。

结果如下：

```Python
Main Proess started
Start process: 0
Start process: 1
Start process: 2
End process 2End process 1

Start process: 3
End process 0
End process 3
Main Process Ended
```

进程值大小为3，所以可以看到3个进程运行，第4个值在等待。在有进程运行完毕之后，第四个进程马上跟着运行，出现了如上的运行结果。最后**用close方法关闭进程池**，使其不再接受新的任务。再调用**join方法**使得主进程等待子进程运行完毕之后，再退出。

###### 更好用的map方法

map方法的使用，第一个参数就是要启动的进程对应的执行方法，第二个参数是一个可迭代对象，其中的每个元素会被传递给这个执行方法。

**举个例子**，比如我们现在有个list，里面有很多url，另外我们也定义了很多方法，用来抓取每个url的内容解析，那么我们可以在map的第一个参数传入这个方法名，第二个参数传入这个url数组。现在我们看个实例。

```python
# Author: Rainsblue.chan
# Create: 2023/6/29
# FileName: 06Pool&map
from multiprocessing import Pool
import urllib.request
import urllib.error

def scrape(url): # 爬取
    try:
        urllib.request.urlopen(url)
        print(f'URL {url} Scraped')
    except (urllib.error.HTTPError, urllib.error.URLError):
        print(f'URL {url} not Scraped')

if __name__ == '__main__':
    pool = Pool(processes=3)
    urls = [
        'https://www.baidu.com',
        'http://www.meituan.com/',
        'http://blog.csdn.net/',
        'http://xxxyxxx.net',
    ]
    pool.map(scrape, urls)
    pool.close()
```

![image-20230629133343286](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629133343286.png)

这种方式非常适用于多进程的执行。下期就会开始正式开搞。

## 模块二

### 07.入门首选，Requests库的基本运用

#### 前言

学习爬虫，最基础的便是模拟浏览器向服务器发送请求

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629135535716.png" alt="image-20230629135535716" style="zoom:50%;" />

Python的强大之处就在于提供功能丰富的类库，来帮助我们完成这些请求。

利用Python现有的库可以非常方便地实现网络请求的模拟，常见的库有**urllib、requests**等。

拿requests举例，有了它，我们只需关心请求的链接是什么，需要传的参数是什么，以及如何设置cookie的参数就好，不用深入到底层通信。

#### 实例引入

用python写爬虫的第一步就是模拟发起一个请求，把网页的源代码获取下来，类似于get类的http请求。浏览器得到源代码后，把它渲染出来就可以看见网页的内容。requests就有一个get方法。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
r = requests.get('http://httpbin.org/')
print(r.text) # 这边如果只是输入r，放回的是一个响应码，比如200
```

返回如下，是一段html源代码。

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>httpbin.org</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Source+Code+Pro:300,600|Titillium+Web:400,600,700"
        rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/flasgger_static/swagger-ui.css">
    <link rel="icon" type="image/png" href="/static/favicon.ico" sizes="64x64 32x32 16x16" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        body {
            margin: 0;
            background: #fafafa;
        }
    </style>
</head>

<body>
    <a href="https://github.com/requests/httpbin" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
            aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg>
    </a>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position:absolute;width:0;height:0">
        <defs>
            <symbol viewBox="0 0 20 20" id="unlocked">
                <path d="M15.8 8H14V5.6C14 2.703 12.665 1 10 1 7.334 1 6 2.703 6 5.6V6h2v-.801C8 3.754 8.797 3 10 3c1.203 0 2 .754 2 2.199V8H4c-.553 0-1 .646-1 1.199V17c0 .549.428 1.139.951 1.307l1.197.387C5.672 18.861 6.55 19 7.1 19h5.8c.549 0 1.428-.139 1.951-.307l1.196-.387c.524-.167.953-.757.953-1.306V9.199C17 8.646 16.352 8 15.8 8z"></path>
            </symbol>

            <symbol viewBox="0 0 20 20" id="locked">
                <path d="M15.8 8H14V5.6C14 2.703 12.665 1 10 1 7.334 1 6 2.703 6 5.6V8H4c-.553 0-1 .646-1 1.199V17c0 .549.428 1.139.951 1.307l1.197.387C5.672 18.861 6.55 19 7.1 19h5.8c.549 0 1.428-.139 1.951-.307l1.196-.387c.524-.167.953-.757.953-1.306V9.199C17 8.646 16.352 8 15.8 8zM12 8H8V5.199C8 3.754 8.797 3 10 3c1.203 0 2 .754 2 2.199V8z"
                />
            </symbol>

            <symbol viewBox="0 0 20 20" id="close">
                <path d="M14.348 14.849c-.469.469-1.229.469-1.697 0L10 11.819l-2.651 3.029c-.469.469-1.229.469-1.697 0-.469-.469-.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-.469-.469-.469-1.228 0-1.697.469-.469 1.228-.469 1.697 0L10 8.183l2.651-3.031c.469-.469 1.228-.469 1.697 0 .469.469.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c.469.469.469 1.229 0 1.698z"
                />
            </symbol>

            <symbol viewBox="0 0 20 20" id="large-arrow">
                <path d="M13.25 10L6.109 2.58c-.268-.27-.268-.707 0-.979.268-.27.701-.27.969 0l7.83 7.908c.268.271.268.709 0 .979l-7.83 7.908c-.268.271-.701.27-.969 0-.268-.269-.268-.707 0-.979L13.25 10z"
                />
            </symbol>

            <symbol viewBox="0 0 20 20" id="large-arrow-down">
                <path d="M17.418 6.109c.272-.268.709-.268.979 0s.271.701 0 .969l-7.908 7.83c-.27.268-.707.268-.979 0l-7.908-7.83c-.27-.268-.27-.701 0-.969.271-.268.709-.268.979 0L10 13.25l7.418-7.141z"
                />
            </symbol>


            <symbol viewBox="0 0 24 24" id="jump-to">
                <path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7z" />
            </symbol>

            <symbol viewBox="0 0 24 24" id="expand">
                <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" />
            </symbol>

        </defs>
    </svg>


    <div id="swagger-ui">
        <div data-reactroot="" class="swagger-ui">
            <div>
                <div class="information-container wrapper">
                    <section class="block col-12">
                        <div class="info">
                            <hgroup class="main">
                                <h2 class="title">httpbin.org
                                    <small>
                                        <pre class="version">0.9.2</pre>
                                    </small>
                                </h2>
                                <pre class="base-url">[ Base URL: httpbin.org/ ]</pre>
                            </hgroup>
                            <div class="description">
                                <div class="markdown">
                                    <p>A simple HTTP Request &amp; Response Service.
                                        <br>
                                        <br>
                                        <b>Run locally: </b>
                                        <code>$ docker run -p 80:80 kennethreitz/httpbin</code>
                                    </p>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <a href="https://kennethreitz.org" target="_blank">the developer - Website</a>
                                </div>
                                <a href="mailto:me@kennethreitz.org">Send email to the developer</a>
                            </div>
                        </div>
                        <!-- ADDS THE LOADER SPINNER -->
                        <div class="loading-container">
                            <div class="loading"></div>
                        </div>

                    </section>
                </div>
            </div>
        </div>
    </div>


    <div class='swagger-ui'>
        <div class="wrapper">
            <section class="clear">
                <span style="float: right;">
                    [Powered by
                    <a target="_blank" href="https://github.com/rochacbruno/flasgger">Flasgger</a>]
                    <br>
                </span>
            </section>
        </div>
    </div>



    <script src="/flasgger_static/swagger-ui-bundle.js"> </script>
    <script src="/flasgger_static/swagger-ui-standalone-preset.js"> </script>
    <script src='/flasgger_static/lib/jquery.min.js' type='text/javascript'></script>
    <script>

        window.onload = function () {
            

            fetch("/spec.json")
                .then(function (response) {
                    response.json()
                        .then(function (json) {
                            var current_protocol = window.location.protocol.slice(0, -1);
                            if (json.schemes[0] != current_protocol) {
                                // Switches scheme to the current in use
                                var other_protocol = json.schemes[0];
                                json.schemes[0] = current_protocol;
                                json.schemes[1] = other_protocol;

                            }
                            json.host = window.location.host;  // sets the current host

                            const ui = SwaggerUIBundle({
                                spec: json,
                                validatorUrl: null,
                                dom_id: '#swagger-ui',
                                deepLinking: true,
                                jsonEditor: true,
                                docExpansion: "none",
                                apisSorter: "alpha",
                                //operationsSorter: "alpha",
                                presets: [
                                    SwaggerUIBundle.presets.apis,
                                    // yay ES6 modules ↘
                                    Array.isArray(SwaggerUIStandalonePreset) ? SwaggerUIStandalonePreset : SwaggerUIStandalonePreset.default
                                ],
                                plugins: [
                                    SwaggerUIBundle.plugins.DownloadUrl
                                ],
            
            // layout: "StandaloneLayout"  // uncomment to enable the green top header
        })

        window.ui = ui

        // uncomment to rename the top brand if layout is enabled
        // $(".topbar-wrapper .link span").replaceWith("<span>httpbin</span>");
        })
    })
}
    </script>  <div class='swagger-ui'>
    <div class="wrapper">
        <section class="block col-12 block-desktop col-12-desktop">
            <div>

                <h2>Other Utilities</h2>

                <ul>
                    <li>
                        <a href="/forms/post">HTML form</a> that posts to /post /forms/post</li>
                </ul>

                <br />
                <br />
            </div>
        </section>
    </div>
</div>
</body>

</html>
```

我们只要把里面想要的内容爬取出来，就完成了。

#### GET请求

如果客户端发起的是GET请求的话，**该网站会判断并返回响应的请求信息**，包括Headers、IP等。

示例如下，我们在后缀加了get。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
r = requests.get('http://httpbin.org/get')
print(r.text)
```

运行结果如下，httpbin.org返回了**响应的请求信息**，包括Headers和IP。

```css
{
  "args": {}, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", # 编码
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.31.0", # 用户请求头，这里就是我的requests库版本
    "X-Amzn-Trace-Id": "Root=1-649d2191-128870be64a80b4224d522ad"
  }, 
  "origin": "120.204.152.106", # IP信息
  "url": "http://httpbin.org/get"
}
```

如果想要添加两个参数，其中name是germey，age是25，URL就可以写出下列内容。

`http://httpbin.org/get?name=germey&age=25`

```css
{
  "args": {
    "age": "25", 
    "name": "germey"
  }, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.31.0", 
    "X-Amzn-Trace-Id": "Root=1-649d3f63-1872130e410d423b2aaff0b7"
  }, 
  "origin": "120.204.152.106", 
  "url": "http://httpbin.org/get?name=germey&age=25"
}
```

在这里，我们可以发现返回了两个参数，其中一个是年龄参数为25，另外一个名字参数为germey。但是手动拼接不太人性化，所以会用到**params参数**。

##### paras参数用法

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
data = {
    'name' : 'rainsbluechan', # 一定要注意别忘了逗号
    'age' : 20
}
r = requests.get('http://httpbin.org/get', params=data) # params引参
print(r.text)
```

这里通过字典的方式传递给params参数，不需要自己再构造url。

##### json格式

如果想直接解析返回结果，得到一个json格式的数据的话，可以直接调用json方法

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
r = requests.get('http://httpbin.org/get')
print(type(r.text))
print(r.json())
print(type(r.json()))
```

结果

```json
<class 'str'>
{'args': {}, 'headers': {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Host': 'httpbin.org', 'User-Agent': 'python-requests/2.31.0', 'X-Amzn-Trace-Id': 'Root=1-649d4222-2631438a7eca1d83079c0356'}, 'origin': '120.204.152.106', 'url': 'http://httpbin.org/get'}
<class 'dict'>
```

调用json方法解析可以使一段字符串转换成一个字典。但如果不是json格式，则会抛出jsondecodeError等异常。

##### 抓取网页

由于课程实例已经过期，所以我打算自己找一个。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
import re

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('https://movie.douban.com/top250', headers=headers) # 伪装本机浏览器标识头 
pattern = re.compile('<span class="title">(.*?)</span>', re.S)
titles = re.findall(pattern, r.text)
print(r.text)
```

首先一个问题，就是如果你不伪装一个电脑的请求头，对于有反爬机制的网站会返给你一个418，那是个咖啡壶冷笑话，I’m teapot。我们可以看一下，这是经典的豆瓣250，俗称爬虫靶场。

![image-20230629170359741](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629170359741.png)

所以我们需要做的事情就是去伪装一个浏览器标头，位置在这里。

![image-20230629170614534](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629170614534.png)

放进去之后，我们用正则表达式进行处理，对第一页的题目进行一个过滤，这里不太追求细节，所以直接看结果。

```dict
['肖申克的救赎', '&nbsp;/&nbsp;The Shawshank Redemption', '霸王别姬', '阿甘正传', '&nbsp;/&nbsp;Forrest Gump', '泰坦尼克号', '&nbsp;/&nbsp;Titanic', '这个杀手不太冷', '&nbsp;/&nbsp;Léon', '千与千寻', '&nbsp;/&nbsp;千と千尋の神隠し', '美丽人生', '&nbsp;/&nbsp;La vita è bella', '辛德勒的名单', '&nbsp;/&nbsp;Schindler&#39;s List', '星际穿越', '&nbsp;/&nbsp;Interstellar', '盗梦空间', '&nbsp;/&nbsp;Inception', '楚门的世界', '&nbsp;/&nbsp;The Truman Show', '忠犬八公的故事', '&nbsp;/&nbsp;Hachi: A Dog&#39;s Tale', '海上钢琴师', '&nbsp;/&nbsp;La leggenda del pianista sull&#39;oceano', '三傻大闹宝莱坞', '&nbsp;/&nbsp;3 Idiots', '放牛班的春天', '&nbsp;/&nbsp;Les choristes', '机器人总动员', '&nbsp;/&nbsp;WALL·E', '无间道', '&nbsp;/&nbsp;無間道', '疯狂动物城', '&nbsp;/&nbsp;Zootopia', '控方证人', '&nbsp;/&nbsp;Witness for the Prosecution', '大话西游之大圣娶亲', '&nbsp;/&nbsp;西遊記大結局之仙履奇緣', '熔炉', '&nbsp;/&nbsp;도가니', '教父', '&nbsp;/&nbsp;The Godfather', '触不可及', '&nbsp;/&nbsp;Intouchables', '当幸福来敲门', '&nbsp;/&nbsp;The Pursuit of Happyness', '怦然心动', '&nbsp;/&nbsp;Flipped']
```

就是一个字典。我们用**re.compile**来匹配所有的标题，然后用**re.findall**来引入做好的pattern参数去处理r.text，最后呈现的就是上面的字典。关于正则表达式，下一讲会有非常详细的介绍。

上面是属于文字类，如果想要抓取图片，音频等二进制文件，应该怎么办呢？

##### 抓取二进制文件

###### r.content

以抓movie.douban.com站点图片为例

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
import re

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('https://movie.douban.com/favicon.ico',headers=headers)
print(r.text)
print(r.content)
```

返回结果如下

```binary
          

                                                                                               (       @                         w Jw çw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw äw Jw æw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw çw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿ‘À‰ÿÿÿÿÿÿÿÿÿøûøÿ|
ÿw ÿw ÿw ÿw ÿ|
ÿøûøÿÿÿÿÿÿÿÿÿ‘À‰ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÕçÒÿÿÿÿÿÿÿÿÿ¾Ú¹ÿw ÿw ÿw ÿw ÿw ÿw ÿ¾Ú¹ÿÿÿÿÿÿÿÿÿÕçÒÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿ+†ÿÿÿÿÿÿÿÿÿÿÿÿÿz³pÿw ÿw ÿw ÿw ÿw ÿw ÿz³pÿÿÿÿÿÿÿÿÿÿÿÿÿ+†ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿn¬dÿÿÿÿÿÿÿÿÿÿÿÿÿ5Œ'ÿw ÿw ÿw ÿw ÿw ÿw ÿ5Œ'ÿÿÿÿÿÿÿÿÿÿÿÿÿn¬dÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿ½Ù¸ÿÿÿÿÿÿÿÿÿäðâÿ/ˆ ÿ/ˆ ÿ/ˆ ÿ/ˆ ÿ/ˆ ÿ/ˆ ÿ/ˆ ÿ/ˆ ÿäðâÿÿÿÿÿÿÿÿÿ½Ù¸ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÛêØÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿÛêØÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿµÕ°ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿµÕ°ÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿµÕ°ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿµÕ°ÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿµÕ°ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿµÕ°ÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿµÕ°ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿµÕ°ÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÛêØÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿˆ»€ÿÛêØÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿÓæÐÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÓæÐÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿâîàÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿâîàÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿâîàÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿâîàÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿâîàÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿâîàÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw æw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw æw Iw æw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw ÿw æw I                                                                                                                                
b'\x00\x00\x01\x00\x02\x00\x10\x10\x00\x00\x01\x00\x08\x00h\x05\x00\x00&\x00\x00\x00  \x00\x00\x01\x00 \x00\xa8\x10\x00\x00\x8e\x05\x00\x00(\x00\x00\x00\x10\x00\x00\x00 \x00\x00\x00\x01\x00\x08\x00\x00\x00\x00\x00\x00\x01\x00\x00\x13\x0b\x00\x00\x13\x0b\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x11w\x00\x00\x1at\x0f\x00\x1av\x10\x00/\x84"\x00:\x88.\x00<\x8c/\x00C\x8d6\x00E\x918\x00G\x90;\x00S\x99G\x00S\x9aH\x00I\x97I\x00K\x99I\x00P\x9aI\x00P\x9bI\x00T\x9eN\x00b\xa3W\x00r\xa9h\x00\x86\xb6~\x00\x93\xbf\x8b\x00\x9a\xc3\x93\x00\xac\xcc\xa6\x00\xd7\xe8\xd1\x00\xde\xec\xdc\x00\xe0\xed\xde\x00\xe7\xf2\xe3\x00\xf7\xfa\xf5\x00\xfc\xfd\xfc\x00\xfd\xfe\xfc\x00\xfe\xfe\xfe\x00\xff\xff\xfe\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x00\x10\x15\x15\x15\x15\x15\x15\x15\x15\x15\x15\x15\x15\x10\x00\x00\x14\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x14\x00\x00\x00\x00\x00\x13\x1f\x11\x01\x01\x11\x1f\x13\x00\x00\x02\x02\x00\x00\x02\x02\x18\x1b\x01\x01\x01\x01\x1f\x18\x00\x02\x02\x02\x00\x00\x02\t\x1f\x1c\x04\x06\x06\x04\x1f\x1a\t\x02\x00\x02\x00\x00\x08\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x08\x00\x02\x00\x00\x08\x1f\x17\x05\x05\x05\x05\x05\x05\x17\x1f\x08\x00\x02\x00\x00\x08\x1f\x19\x01\x01\x01\x01\x01\x01\x16\x1f\x08\x00\x02\x00\x00\x08\x1f\x17\x0f\x0b\x0e\r\x0c\x0b\x17\x1f\x08\x00\x02\x00\x00\x08\x1f\x1d\x1f\x1e\x1e\x1e\x1e\x1e\x1f\x1f\x08\x00\x00\x00\x00\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x00\x00\x03\x12\x12\x12\x12\x12\x12\x12\x12\x12\x12\x12\x12\x03\x00\x00\n\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\x1f\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00(\x00\x00\x00 \x00\x00\x00@\x00\x00\x00\x01\x00 \x00\x00\x00\x00\x00\x00\x10\x00\x00\x13\x0b\x00\x00\x13\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11w\x00J\x11w\x00\xe7\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xe4\x11w\x00J\x11w\x00\xe6\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xe7\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x91\xc0\x89\xff\xff\xff\xff\xff\xff\xff\xff\xff\xf8\xfb\xf8\xff\x1a|\n\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x1a|\n\xff\xf8\xfb\xf8\xff\xff\xff\xff\xff\xff\xff\xff\xff\x91\xc0\x89\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd5\xe7\xd2\xff\xff\xff\xff\xff\xff\xff\xff\xff\xbe\xda\xb9\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xbe\xda\xb9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd5\xe7\xd2\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff+\x86\x1c\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xffz\xb3p\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xffz\xb3p\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff+\x86\x1c\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xffn\xacd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff5\x8c\'\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff5\x8c\'\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xffn\xacd\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xbd\xd9\xb8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xe4\xf0\xe2\xff/\x88 \xff/\x88 \xff/\x88 \xff/\x88 \xff/\x88 \xff/\x88 \xff/\x88 \xff/\x88 \xff\xe4\xf0\xe2\xff\xff\xff\xff\xff\xff\xff\xff\xff\xbd\xd9\xb8\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xdb\xea\xd8\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\xdb\xea\xd8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xb5\xd5\xb0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xb5\xd5\xb0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xb5\xd5\xb0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xb5\xd5\xb0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xb5\xd5\xb0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xb5\xd5\xb0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xb5\xd5\xb0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xb5\xd5\xb0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xdb\xea\xd8\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\x88\xbb\x80\xff\xdb\xea\xd8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xd3\xe6\xd0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xd3\xe6\xd0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xe2\xee\xe0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xe2\xee\xe0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xe2\xee\xe0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xe2\xee\xe0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\xe2\xee\xe0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xe2\xee\xe0\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xe6\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xe6\x11w\x00I\x11w\x00\xe6\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xff\x11w\x00\xe6\x11w\x00I\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

这里打印了response的两个属性，一个是**text**，一个是**content**。

###### open方法

前者出现乱码，后者带有一个**b**，这代表是**bytes类型**的数据，由于图片是二进制数据，所以前者在打印时转化为str类型，也就是图片直接转化为字符串，所以会出现乱码。我们现在尝试把它保存下来。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
import re

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('https://movie.douban.com/favicon.ico',headers=headers)
with open('favicon.ico', 'wb') as f:
    f.write(r.content)
```

成功地保存了。这里我们调用了**open方法**，第一个参数是文件名称，第二个参数，我们以**二进制**的形式保存，这里使用到的是**'wb'（writable binary，二进制写入）**，可以向文件写入二进制数据。运行结束后就出现下面的图片。音频、视频类也可以同样根据这个方式进行获取。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230629173207567.png" alt="image-20230629173207567" style="zoom: 33%;" />

###### 请求头设置

在发起一个HTTP请求时，会有一个请求头**Request Headers**，我们看看如何设置。

**使用headers参数**。上面写了一个，不再赘述。它的作用就是伪装成别的，不被网站识别成反爬。

#### Post请求

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
data = {
    'name' : 'germey',
    'age' : 25
}
r = requests.post('http://httpbin.org/post', headers=headers, data=data)
print(r.text)
```

成功返回结果

```json
{
  "args": {}, 
  "data": "", 
  "files": {}, 
  "form": {
    "age": "25", 
    "name": "germey"
  }, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Content-Length": "18", 
    "Content-Type": "application/x-www-form-urlencoded", 
    "Host": "httpbin.org", 
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36", 
    "X-Amzn-Trace-Id": "Root=1-649d8616-5060659b305e96a25453095b"
  }, 
  "json": null, 
  "origin": "42.3.79.113", 
  "url": "http://httpbin.org/post"
}
```

其中**form就是我们提交的表单数据**，这就说明我们成功发送了。

#### 响应（Response）

发送请求后，自然就会得到响应。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('https://movie.douban.com/top250',headers=headers)
print(type(r.status_code), r.status_code)
print(type(r.headers), r.headers)
print(type(r.cookies), r.cookies)
print(type(r.url), r.url)
print(type(r.history), r.history)
```

返回的响应如下

```css
<class 'int'> 200 # 状态码
<class 'requests.structures.CaseInsensitiveDict'> {'Date': 'Thu, 29 Jun 2023 13:30:17 GMT', 'Content-Type': 'text/html; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Keep-Alive': 'timeout=30', 'X-Xss-Protection': '1; mode=block', 'X-Douban-Mobileapp': '0', 'Expires': 'Sun, 1 Jan 2006 01:00:00 GMT', 'Pragma': 'no-cache', 'Cache-Control': 'must-revalidate, no-cache, private', 'Set-Cookie': 'ck="deleted"; max-age=0; domain=.douban.com; expires=Thu, 01-Jan-1970 00:00:00 GMT; path=/, dbcl2="deleted"; max-age=0; domain=.douban.com; expires=Thu, 01-Jan-1970 00:00:00 GMT; path=/, bid=6P0GEKRQnfk; Expires=Fri, 28-Jun-24 13:30:17 GMT; Domain=.douban.com; Path=/', 'X-DAE-App': 'movie', 'X-DAE-Instance': 'default', 'X-DOUBAN-NEWBID': '6P0GEKRQnfk', 'Server': 'dae', 'Strict-Transport-Security': 'max-age=15552000', 'X-Content-Type-Options': 'nosniff', 'Content-Encoding': 'gzip'} # 头部字典
<class 'requests.cookies.RequestsCookieJar'> <RequestsCookieJar[<Cookie bid=6P0GEKRQnfk for .douban.com/>]> # cookies
<class 'str'> https://movie.douban.com/top250 # url
<class 'list'> []
```

requests还提供了一个内置的状态码查询对象**requests.codes**

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('https://movie.douban.com/top250',headers=headers)
exit() if not r.status_code == requests.codes.ok else print('Request Successfully')
```

返回结果如下，这说明没问题，哈哈。

`Request Successfully`

##### 状态码

```json
# 信息性状态码
100: ('continue',),
101: ('switching_protocols',),
102: ('processing',),
103: ('checkpoint',),
122: ('uri_too_long', 'request_uri_too_long'),

# 成功状态码
200: ('ok', 'okay', 'all_ok', 'all_okay', 'all_good', '\\o/', '✔'),
201: ('created',),
202: ('accepted',),
203: ('non_authoritative_info', 'non_authoritative_information'),
204: ('no_content',),
205: ('reset_content', 'reset'),
206: ('partial_content', 'partial'),
207: ('multi_status', 'multiple_status', 'multi_stati', 'multiple_stati'),
208: ('already_reported',),
226: ('im_used',),

# 重定向状态码
300: ('multiple_choices',),
301: ('moved_permanently', 'moved', '\\o-'),
302: ('found',),
303: ('see_other', 'other'),
304: ('not_modified',),
305: ('use_proxy',),
306: ('switch_proxy',),
307: ('temporary_redirect', 'temporary_moved', 'temporary'),
308: ('permanent_redirect',
      'resume_incomplete', 'resume',), # These 2 to removed in 3.0

# 客户端错误状态码
400: ('bad_request', 'bad'),
401: ('unauthorized',),
402: ('payment_required', 'payment'),
403: ('forbidden',),
404: ('not_found', '-o-'),
405: ('method_not_allowed', 'not_allowed'),
406: ('not_acceptable',),
407: ('proxy_authentication_required', 'proxy_auth', 'proxy_authentication'),
408: ('request_timeout', 'timeout'),
409: ('conflict',),
410: ('gone',),
411: ('length_required',),
412: ('precondition_failed', 'precondition'),
413: ('request_entity_too_large',),
414: ('request_uri_too_large',),
415: ('unsupported_media_type', 'unsupported_media', 'media_type'),
416: ('requested_range_not_satisfiable', 'requested_range', 'range_not_satisfiable'),
417: ('expectation_failed',),
418: ('im_a_teapot', 'teapot', 'i_am_a_teapot'), # 1998茶壶冷笑话，反爬虫机制
421: ('misdirected_request',),
422: ('unprocessable_entity', 'unprocessable'),
423: ('locked',),
424: ('failed_dependency', 'dependency'),
425: ('unordered_collection', 'unordered'),
426: ('upgrade_required', 'upgrade'),
428: ('precondition_required', 'precondition'),
429: ('too_many_requests', 'too_many'),
431: ('header_fields_too_large', 'fields_too_large'),
444: ('no_response', 'none'),
449: ('retry_with', 'retry'),
450: ('blocked_by_windows_parental_controls', 'parental_controls'),
451: ('unavailable_for_reasons', 'legal_reasons'),
499: ('client_closed_request',),

# 服务端错误状态码
500: ('internal_server_error', 'server_error', '/o\\', 'X'),
501: ('not_implemented',),
502: ('bad_gateway',),
503: ('service_unvailable', 'unvailable'),
504: ('gateway_timeout',),
505: ('http_version_not_supported', 'http_version'),
506: ('variant_also_negotiates',),
507: ('insufficient_storage',),
509: ('bandwidth_limit_exceeded', 'bandwidth'),
510: ('not_extended',),
511: ('network_authentication_required', 'network_auth', 'network_authentication')
```

#### 高级用法（文件上传，cookies设置，代理设置...etc）

##### 文件上传 

我们知道request可以模拟提交一些数据，例如有的网站它需要上传一些文件，我们也可以用它来实现。在上面我们抓取了豆瓣的ico，那么我们现在来模拟上传的过程。

```python
# Author: Rainsblue.chan
# Create: 2023/6/30
# FileName: requests.post
import requests

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
files = {'file' : open('favicon.ico', 'rb')}
r = requests.post('http://httpbin.org/post',headers=headers, files=files)
print(r.text)
```

结果如下

```json
{
  "args": {}, 
  "data": "", 
  "files": {
    "file": "data:application/octet-stream;base64,AAABAAIAEBAAAAEACABoBQAAJgAAACAgAAABACAAqBAAAI4FAAAoAAAAEAAAACAAAAABAAgAAAAAAAABAAATCwAAEwsAAAABAAAAAQAAEXcAABp0DwAadhAAL4QiADqILgA8jC8AQ402AEWROABHkDsAU5lHAFOaSABJl0kAS5lJAFCaSQBQm0kAVJ5OAGKjVwByqWgAhrZ+AJO/iwCaw5MArMymANfo0QDe7NwA4O3eAOfy4wD3+vUA/P38AP3+/AD+/v4A///+AP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAcAEBUVFRUVFRUVFRUVFRAAABQfHx8fHx8fHx8fHx8UAAAAAAATHxEBAREfEwAAAgIAAAICGBsBAQEBHxgAAgICAAACCR8cBAYGBB8aCQIAAgAACB8fHx8fHx8fHx8IAAIAAAgfFwUFBQUFBRcfCAACAAAIHxkBAQEBAQEWHwgAAgAACB8XDwsODQwLFx8IAAIAAAgfHR8eHh4eHh8fCAAAAAACAgICAgICAgICAgICAAADEhISEhISEhISEhISAwAACh8fHx8fHx8fHx8fHwoAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAACAAAABAAAAAAQAgAAAAAAAAEAAAEwsAABMLAAAAAAAAAAAAABF3AEoRdwDnEXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AOQRdwBKEXcA5hF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AOcRdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP+RwIn////////////4+/j/GnwK/xF3AP8RdwD/EXcA/xF3AP8afAr/+Pv4////////////kcCJ/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/9Xn0v///////////77auf8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP++2rn////////////V59L/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8rhhz/////////////////erNw/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/3qzcP////////////////8rhhz/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/26sZP////////////////81jCf/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/NYwn/////////////////26sZP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/vdm4////////////5PDi/y+IIP8viCD/L4gg/y+IIP8viCD/L4gg/y+IIP8viCD/5PDi////////////vdm4/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/0+bQ/////////////////////////////////////////////////////////////////////////////////////////////////9Pm0P8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP/T5tD/////////////////////////////////////////////////////////////////////////////////////////////////0+bQ/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/9Pm0P///////////9vq2P+Iu4D/iLuA/4i7gP+Iu4D/iLuA/4i7gP+Iu4D/iLuA/4i7gP+Iu4D/iLuA/4i7gP/b6tj////////////T5tD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/0+bQ////////////tdWw/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/7XVsP///////////9Pm0P8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP/T5tD///////////+11bD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/tdWw////////////0+bQ/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/9Pm0P///////////7XVsP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP+11bD////////////T5tD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/0+bQ////////////tdWw/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/7XVsP///////////9Pm0P8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP/T5tD////////////b6tj/iLuA/4i7gP+Iu4D/iLuA/4i7gP+Iu4D/iLuA/4i7gP+Iu4D/iLuA/4i7gP+Iu4D/2+rY////////////0+bQ/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/9Pm0P/////////////////////////////////////////////////////////////////////////////////////////////////T5tD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/0+bQ/////////////////////////////////////////////////////////////////////////////////////////////////9Pm0P8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/+Lu4P//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////4u7g/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/4u7g///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////i7uD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP/i7uD//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Lu4P8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AOYRdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwDmEXcASRF3AOYRdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA/xF3AP8RdwD/EXcA5hF3AEkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
  }, 
  "form": {}, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Content-Length": "5833", 
    "Content-Type": "multipart/form-data; boundary=bf2280ed84a32fc7579faaebc1a503ba", 
    "Host": "httpbin.org", 
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36", 
    "X-Amzn-Trace-Id": "Root=1-649e4cb4-01ffeef01bfed6f802bc2102"
  }, 
  "json": null, 
  "origin": "120.204.152.210", 
  "url": "http://httpbin.org/post"
}
```

里面包含files这个字段，而form字段是空的，证明文件上传部分会单独有一个files字段来标识。

##### Cookies

还是看一个示例，这个只要一个**r.cookies**就能反回来。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}

r = requests.get('http://www.baidu.com', headers=headers)
print(r.cookies)
for key, value in r.cookies.items():
    print(key + '=' + value)
```

我们看结果

```json
<RequestsCookieJar[<Cookie H_PS_PSSID=36551_38942_38857_38798_38959_38831_38915_38973_38805_38986_38638_38867_26350 for .baidu.com/>, <Cookie BDSVRTM=38 for www.baidu.com/>, <Cookie BD_HOME=1 for www.baidu.com/>]>
H_PS_PSSID=36551_38942_38857_38798_38959_38831_38915_38973_38805_38986_38638_38867_26350
BDSVRTM=38
BD_HOME=1
```

这里我们首先调用cookies这个属性就可以成功得到它了。可以发现它是**<RequestCookieJar>**这样的类型。然后我们用items方法就可以把它转换成元组组成的列表，遍历输出每一个cookie，可以看到下面的名称和值。接下来是网站示例，首先我们先登录自己的github。

![image-20230630114554203](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230630114554203.png)

将这段cookie复制下来，放入自己的cookie

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

# 建议挂个代理，我是挂代理才有的回显
# proxies={http:xxxx}类似，然后r里加参数
headers={
    'Cookie': 'your-cookie',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}

r = requests.get('https://www.github.com/', headers=headers)
print(r.text)
```

返回特别长，我们就看当中一些具体信息即可。只要包含自己的github用户名即可。

##### RequestsCookieJar（个人感觉比上面好，独立处理）

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

# 设置代理
proxies = {
    "http": "http://127.0.0.1:4780",
    "https": "http://127.0.0.1:4780",
}

# RequestCookieJar
cookies =  'your-cookie'
jar = requests.cookies.RequestsCookieJar()

# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
for cookie in cookies.split(';'):
    key, value = cookie.split('=', 1)
    jar.set(key, value)
r = requests.get('https://www.github.com/', headers=headers, proxies=proxies, cookies=jar)
print(r.text)
```

我们这里新建了一个**RequestsCookieJar对象**，然后将复制下来的cookie用split方法进行分割，**（使用分号，因为截下来有分号）**，这里key和value只在第一个 = 分割一次，随后用set方法生成好每个cookie的key和value。

![image-20230630162034468](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230630162034468.png)

有上述回返则正确。

##### Session维持

在requests中，如果直接利用get或post等方法的确可以做到模拟网页的请求，但是**这实际是相当于不同的Session**，相当于你用两个浏览器打开了不同的界面。

设想这样一个场景，我们先用post方法打开了一个网站，第二次，我们想要获取登录成功后的个人信息，我们可能采用一次get方法得到个人信息的页面，这就是两个不相关的session，但是这样当然不能一次成功。

方式是在两次请求时设置一样的cookie，但是这样会比较繁琐，有什么方式可以解决它呢？

**维持同样的session，也就是打开新的浏览器选项卡，而不是新开一个浏览器。**又不想要每次都设置cookies，这时候就有新方法，**session对象**。利用session对象，我们可以维护一个session，而且不用担心cookies的问题，它会自动处理好。示例如下。先是一个不成功的。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

# 设置代理
proxies = {
    "http": "http://127.0.0.1:4780",
    "https": "http://127.0.0.1:4780",
}

# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
requests.get('http://httpbin.org/cookies/set/number/123456789', headers=headers, proxies=proxies)
r = requests.get('http://httpbin.org/cookies')
print(r.text)
```

结果就是下面这个

```css
{
  "cookies": {}
}
```

下面用session对象的方法

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests

# 设置代理
proxies = {
    "http": "http://127.0.0.1:4780",
    "https": "http://127.0.0.1:4780",
}

# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
s = requests.Session()
s.get('http://httpbin.org/cookies/set/number/123456789', headers=headers, proxies=proxies)
r = s.get('http://httpbin.org/cookies')
print(r.text)
```

那么就会有回显。

```css
{
  "cookies": {
    "number": "123456789"
  }
}
```

这样更能体会到**同一个session和不同session之间的区别**了。可以模拟同一个session，然后再进行下一步操作。

##### SSL证书验证

现在很多网站都要求使用HTTPS协议，但是有些网站可能并没有设置好HTTPS证书，或者不被CA机构认可（如**中铁**），这时这些**网站可能就会出现SSL证书错误的提示**。

我们可以通过一些方法爬取这些无证明的网站。可以使用**verify参数**控制是否验证证书，如果将其设置为False，在请求时就不会再验证证书是否有效，如果不加verify参数的话，默认值是True，会自动验证。我找一个这样的网站嗷。对不起找不到（懒得）

```python
import requests
from requests.packages import urllib3
# 方式1：设置忽略警告方式，屏蔽警告
urllib3.disable_warnings() 
# 方式2：可以通过捕获日志的方式来忽略它
import logging
logging.captureWarnings(True)
response = requests.get('https://某个没ca证书的url', verify=False) # 不检验有效
print(response.status_code) # 检验是否可通
# 方式3：可以指定一个本地证书用作客户端证书，可以是单个文件（包含密钥和证书）或一个包含两个文件路径的元组
response = requests.get('https://某个没ca证书的url', cert=('/path/server.crt', '/path/server.key'))
print(response.status_code)
```

##### 超时设置

本机网络状态不好或者服务器网络响应延迟甚至无响应时，会等待很久才能收到响应，甚至到最后收不到响应而报错，为防止服务器不能及时响应，应该设置一个超时时间，即超过了这个时间还没有得到响应，就报错，这需要用到**timeout参数**。

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('http://httpbin.org/get', headers=headers, timeout=1)
print(r.status_code)
```

**如果1秒内没有响应的话，那么就会爆出异常**，这里基本是异常，因为太快了。

实际上，请求分为两个阶段，即**连接阶段**和**读取阶段**。这里用的timeout是两者时间的总和，如果要分别设置，可以传入一个元组类似于下面这一行。

`r = requests.get('https://httpbin.org/get', timeout=(5, 30))`

如果想**永久等待**，可以直接将timeout设置为**None**，或者不设置直接留空，因为默认是None。

##### 身份认证

访问某些设置了身份认证的网站时，网站由于启用了基本身份认证，用户登录需要输入用户名和密码作为登录凭证。

如果遇到这种形式，怎么用requests来爬取呢？

我们可以使用requests自带的身份认证功能，通过**auth参数**即可设置。

```python
import requests
from requests.auth import HTTPBasicAuth

r = requests.get('url', auth=HTTPBasicAuth('admin, 'admin')) # 用户和密码都是admin
print(r.status_code)
```

如果用户名和密码正确的话，那么会认证成功，返回200，失败，则返回401.

简写就是直接这一条

`r = requests.get('url', auth=('admin','admin))`

还提供了其他认证方式，如**OAuth认证**，不过此时需要安装oauth包。

##### 代理设置

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
import requests
# 代理
proxies={
    'http' : 'http://127.0.0.1:4780', # 一定要注意逗号
    'https' : 'http://127.0.0.1:4780',
}
# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
r = requests.get('http://bilibili.com', headers=headers, proxies=proxies)
print(r.status_code)
```

如果代理需要使用到身份认证，就按下列。

`proxies = {'https':'http://user:password@10.10.10.10:1080/',}`

requests还支持SOCKS协议的代理，需要安装socks库。

##### Prepared Request（独立对象）

不用get方法，直接构造一个Prepared Request对象

```python
# Author: Rainsblue.chan
# Create: 2023/6/27
# FileName: requests.get
from requests import Request, Session
# 代理
proxies={
    'http' : 'http://127.0.0.1:4780',
    'https' : 'http://127.0.0.1:4780',
}
# 请求头
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'
}
url = 'http://httpbin.org/post'
data = {'name':'germey'}
s = Session()
req = Request('POST', url, data=data, headers=headers)
prepped = s.prepare_request(req)
r = s.send(prepped)
print(r.text)
```

这样就可以灵活调度，一次好几个页面。

### 08.解析无所不能的正则表达式

