---
layout:     post
title:      爬虫自研笔记
subtitle:   潜龙，勿用
date:       1900-01-01
author:     Rainsblue.chan
header-img: ![3](../../../wallpaper/3.jpg)
catalog:   true
tags:
    - 经验
---
## 爬虫自研笔记
### 前言

​		用于学习爬虫的笔记，共勉。采用的课程为拉钩教育的爬虫课。

### 01.必知必会，掌握HTTP基本原理

#### URI、URL、URN

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621202914020.png" alt="image-20230621202914020" style="zoom:50%;" />

```URI和URL
例如：
https://github.com/favicon.ico既是一个URL，也是一个URI。
即有这样的一个图标资源，用URL/URI来唯一指定了它的访问方式，
这其中包括了访问协议HTTPS、访问路径（即github的根目录）和资源名称favicon.ico
```

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621203232056.png" alt="image-20230621203232056" style="zoom:50%;" />

URL（统一资源定位符）是URI（统一资源标识符）的一个子集，URI还有一个子类叫做URN（统一资源名称，**它只负责命名资源而不制定如何定位资源**）。所以这个URL的作用是资源的**定位**，这是标识的一个细化，可以说是**特别的标识**。**只要一个资源有定位符，它则一定是URI的一种**。

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621203547812.png" alt="image-20230621203547812" style="zoom:50%;" />

我们看这幅图和这个例子，URN命名了一本书作为资源，它可以唯一标识这本书，**但是没有指定到哪里定位这本书**。

现在一般URN非常少，URL也可称作为URI（**网页链接**）。

![image-20230621204812916](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621204812916.png)

ctrl+u查看源代码，都是超文本。

#### HTTP和HTTPS概念

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621204937712.png" alt="image-20230621204937712" style="zoom:50%;" />

URL开头的这个http或者https就是访问资源所需要的协议类型。这两股协议是最常见的。我们来了解一下它们的含义。

![image-20230621205304617](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205304617.png)

```HTTP概念
HTTP（Hyper Text Transfer Protocol）
中文名叫做超文本传输协议，用于从网络传输超文本数据到本地浏览器的传送协议，能保证高效而准确地传送超文本文档。
由来是万维网协会和IETF（互联网工作小组）共同指定的规范。
目前广泛使用的HTTP1.1版本。
```

![image-20230621205623679](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205623679.png)

```HTTPS概念
多了一个套接层，SSL。大势所趋。
它的主要作用可以分为两种：
1.建立一个信息安全通道，来保证数据传输的安全
2.确认网站的真实性，凡是使用了HTTPS的网站，都可以通过点击浏览器地址的锁头标志来查看网站认证之后的真实信息，也可以通过CA机构颁发的安全签章来查询。
```

![image-20230621205952581](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621205952581.png)

#### HTTP请求过程

![image-20230621210134303](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621210134303.png)

输入URL，回车，实质是浏览器向网站服务器发送一个请求request，网站服务器接受到这个请求进行处理和解析，返回对应的response，传回给浏览器。响应里面会有网页源代码，浏览器会对这些超文本进行一个解析，就比如标签直接读掉，类似这种。

##### 开发者工具network选项卡使用

![image-20230621211021477](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621211021477.png)

![image-20230621211716430](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621211716430.png)

我们打开百度，进入开发者工具，查看网络选项卡。这里以我自己的截图举例子，我们看见网络下面有几个块，名称，状态，类型（type，指我们所请求的文件类型），启动器，大小，响应时间和可视化瀑布流。

我们这里以名称为“www.baidu.com"举例，它的状态为200，就是正常，类型为document，代表我们这里请求的是一个**“html文档”**，size如果是cache就是缓存的概念，说明曾经打开过这个网站？不是很理解，但是不太重要。

这里type这个标签还是很重要的吧。

![image-20230621212051878](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621212051878.png)

点开它，能够详细看到它的一些信息。

##### General部分

Request URL是指请求的网页，Request Method是指请求方法，Status Code为状态码，Remote Address，远程服务器地址端口，Referer Policy是判别策略。

响应头和请求头，请求头中带有许多请求信息，例如**浏览器标识**，**cookie**，**Host**等信息。这是请求的一部分。

![image-20230621225725985](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225725985.png)

服务器会**根据请求头内的信息判断请求是否合法**，进而做出对应的响应。Response Headers就是响应的一部分。

![image-20230621225923041](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225923041.png)

当中包含了服务器的类型，文档的类型，日期，这里GMT就是格林威治时间，我们在东八区，所以可知我现在是2023年6月21号晚上九点十六分在百度进行了一次请求。Server这里是百度自己的服务器，我搜了一下。

![image-20230621230258564](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621230258564.png)

还有一篇相关问答，[说是用来代替阿帕奇的](http://www.aiyiweb.com/linux/22997)。链接附在这段字下面了。

浏览器接收到响应会解析响应内容并显示在网页上。

#### 请求（GET和POST）

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621230613872.png" alt="image-20230621230613872" style="zoom:50%;" />

![image-20230621231325437](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621231325437.png)

做web题的时候也常用这种方式，就是一个？跟着所需参数=某个数值。经常就是?c=system('tac fla?.txt');这种形式，就是**GET传参**

![image-20230621231340881](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621231340881.png)

这点也有一点点体会，我记得post传参是以表单的形式，不是在url中修改，一般都是hackbar直接post。我们看一下区别。

![image-20230621232259056](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232259056.png)

就两个区别，一个是get传参写在url里面，post是写在请求体里的，另外一个是字节限制，get最多1024bytes，post则没有限制。

一般来说，登陆时包含了登陆密码，其中涉及到了**敏感信息**，使用GET的方式，密码就会暴露在url里面，造成密码的泄露，所以最好以post的方式发送，较大也会用post。

还有一些其他的请求方式，总结为下表。

![image-20230621232805049](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232805049.png)

请求的网址，即**统一资源定位符URL**，可以唯一确定我们想请求的资源。请求头说明了附加信息，比较重要的信息有**cookie、referer、user-agent**

#### （重要）请求头分析（cookie、referer、user-agent）

![image-20230621232916967](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621232916967.png)

![image-20230621233228239](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233228239.png)

![image-20230621233542244](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233542244.png)

![image-20230621233736681](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621233736681.png)

![image-20230621234028796](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234028796.png)

```分析ing
Accept：请求报头域，用于指定客户端可接受哪些类型的信息
这里我们看，text/html代表html格式，也有图像类image/apng代表apng图片，application/xhtml+xml代表xhtml+xml类型。当中其实是Content-Type，对照表网址为http://tool.oschina.net/commons,
Accept-Language：指定客户端可接受的语言类型
这里支持中文英文。
Accept-Encoding：指定客户端可接受的内容编码
gzip，deflate，br
Host：用于指定请求资源的主机IP和端口号，其内容为请求URL的原始服务器或网关的位置，从HTTP1.1版本开始，请求必须包含此内容
这里看见Host就是baidu。
Cookie：很重要，这是网站为了辨别用户进行会话跟踪而存储在用户本地的数据，它的主要功能是维持当前访问会话。如果你讲一个登陆了的网站的cookie删除，那么自动你就从网页中掉出去。上面那张图解释的很清楚了。
```

![image-20230621234055032](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234055032.png)

![image-20230621234128871](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234128871.png)

![image-20230621234331459](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234331459.png)

所以Referer是标识请求来源，UA则是标识客户使用的操作系统及版本，比如你可以使得一个普通浏览器换成微信浏览器的标识，这样你就可以伪装成微信浏览器。

在写爬虫时，大部分时间都需要请求头。

#### 请求体

![image-20230621234655724](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621234655724.png)

登录github输入完账号密码，这样回车之后就会以表单形式提交给服务器，此时需要注意，**request headers制定content-type为application/x-www-form-urlencoded**，才会以表单的数据形式提交。以url形式编码。

也可以将content-type设置为json，来提交json的内容。或者设置multipart/form-data来上传文件。

![image-20230621235325396](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235325396.png)

在制作爬虫时，如果需要使用post，必须正确了解content-type。、

#### 响应体

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235456734.png" alt="image-20230621235456734" style="zoom:50%;" />

有各种状态码，一般200就是正常返回数据。其他遇到问题再搜。

![image-20230621235602881](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621235602881.png)

![image-20230621225923041](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230621225923041.png)

响应编码为gzip，文档类型返回为text/html，html文档，用的utf-8编码，Server为百度自研1.1，这里有三个set-cookies，我估计是有不同的地方会用到，比如搜索栏，比如登录。

![image-20230622000611300](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230622000611300.png)

响应体就是爬虫最后要解析的东西。

请求网页返回html源码，而图片则是它的二进制。

### 02.夯实根基，Web 网页基础

#### 网页的组成三大件：HTML、JavaScript、CSS

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230622213016300.png" alt="image-20230622213016300" style="zoom:67%;" />

HTML相当于骨架、CSS是渲染格式，所以是皮肤、JavaScript是脚本，执行操作，所以相当于人体运动的肌肉，三者完整结合在一起才能形成网页。

#### HTML（Hyper Text Markup Language，超文本标记语言）

HTML是用来**描述网页**的一种语言

<img src="https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624113333616.png" alt="image-20230624113333616" style="zoom:67%;" />

不同类型的元素通过不同类型标签来表示，如上图所示。

在网页当中选择开发者模式，elements选项卡中展示的就是HTML源码。下图为示例。

这里就是用div嵌套做一个个模块。

![image-20230624113600325](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624113600325.png)

![image-20230624122903222](https://cdn.jsdelivr.net/gh/rainsbluechan/blogimage@main/img/image-20230624122903222.png)

#### CSS（）

